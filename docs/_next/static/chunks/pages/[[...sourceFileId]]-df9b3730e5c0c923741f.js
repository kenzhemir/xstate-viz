(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{750:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var r=n(5893),i=n(8017),o=n(5754),a=n(4115),s=function(e){var t=e.text;return(0,r.jsxs)(i.xu,{paddingTop:"6",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",children:[(0,r.jsx)(o.$,{size:"xl"}),(0,r.jsx)(a.x,{marginTop:"4",children:t})]})}},9412:function(e,t,n){"use strict";n.d(t,{w:function(){return a},b:function(){return s}});var r=n(3934),i=(0,n(8052).Q6)("Embed"),o=(0,r.Z)(i,2),a=o[0],s=o[1]},4486:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Yi}});var r,i=n(5893),o=n(3934),a=n(809),s=n.n(a),c=n(266),l=n(2809),d=n(895),u=n(8017),f=n(6353),h=n(3168),p=n(5142),v=n(1163),g=n(7294),x=n(4336),y=n(9008),m=!0,j=function(e){var t=e.importElk,n=void 0===t||t,r=(0,x.Z)(e,["importElk"]);return(0,i.jsxs)(y.default,{children:[(0,i.jsx)("link",{rel:"apple-touch-icon",href:"/favicon@256.png"}),(0,i.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.png"}),(0,i.jsx)("title",{children:r.title}),(0,i.jsx)("meta",{name:"description",content:r.description}),n&&(0,i.jsx)("script",{src:"https://unpkg.com/elkjs@0.7.1/lib/elk.bundled.js"}),(0,i.jsx)("meta",{property:"og:type",content:"website"}),(0,i.jsx)("meta",{property:"og:url",content:"[EDITOR_LINK]"}),(0,i.jsx)("meta",{property:"og:title",content:r.ogTitle}),(0,i.jsx)("meta",{property:"og:description",content:r.description}),r.ogImageUrl&&m&&(0,i.jsx)("meta",{property:"og:image",content:r.ogImageUrl}),(0,i.jsx)("meta",{property:"twitter:card",content:"summary_large_image"})]})},E=n(7755),b=n(8052),O=(0,b.Q6)("Canvas"),w=(0,o.Z)(O,2),S=w[0],P=w[1],T=n(5305),D=n(862),C=n(7546),I=n(5061),R=n(2026),k=n(5754),N=n(7101),A=n(8420),_=n(2800),z=n(7370),L=n(7273),M=n(9444),V=n(8029),Z=n(375),G=n(6310),U=n(8415);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.slow=1.09]="slow",e[e.normal=1.15]="normal"}(r||(r={}));var H=Y(Y({},{zoom:1,viewbox:{minX:0,minY:0},canvasPanelPosition:{offsetY:50,offsetX:0,width:0,height:0}}),{},{elkGraph:void 0,embed:void 0}),B=(0,G.createModel)(H,{events:{"ZOOM.OUT":function(e,t){return{zoomFactor:t,point:e}},"ZOOM.IN":function(e,t){return{zoomFactor:t,point:e}},"POSITION.RESET":function(){return{}},PAN:function(e,t){return{dx:e,dy:t}},"PAN.LEFT":function(e){return{isLongPan:e}},"PAN.RIGHT":function(e){return{isLongPan:e}},"PAN.UP":function(e){return{isLongPan:e}},"PAN.DOWN":function(e){return{isLongPan:e}},SOURCE_CHANGED:function(e){return{id:e}},CANVAS_RECT_CHANGED:function(e,t,n,r){return{offsetX:t,offsetY:e,width:n,height:r}},"elkGraph.UPDATE":function(e){return{elkGraph:e}},FIT_TO_CONTENT:function(){return{}}}}),W=r.normal,K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.normal;return 1/e},X=function(e){return!(null!==e&&void 0!==e&&e.isEmbedded)||e.zoom},q=function(e){return e.zoom>.1},J=function(e){return e.zoom<2},$=function(e,t){var n=t.translationPoint,r=void 0===n?function(e){var t=e.canvasPanelPosition;return{x:t.offsetX+t.width/2,y:t.offsetY+t.height/2}}(e):n,i=t.zoomFactor,o=e.zoom,a=e.viewbox,s=e.zoom*i,c=r.x-e.canvasPanelPosition.offsetX,l=r.y-e.canvasPanelPosition.offsetY;return{zoom:s,viewbox:{minX:(c+a.minX)*(s/o)-c,minY:(l+a.minY)*(s/o)-l}}},Q=B.createMachine({on:{CANVAS_RECT_CHANGED:{actions:B.assign((function(e,t){return{canvasPanelPosition:{offsetY:t.offsetY,offsetX:t.offsetX,height:t.height,width:t.width}}}))},"ZOOM.OUT":{actions:B.assign((function(e,t){return $(e,{translationPoint:t.point,zoomFactor:K(t.zoomFactor)})})),cond:function(e){return X(e.embed)&&q(e)},target:".throttling",internal:!1},"ZOOM.IN":{actions:B.assign((function(e,t){return $(e,{translationPoint:t.point,zoomFactor:t.zoomFactor||W})})),cond:function(e){return X(e.embed)&&J(e)},target:".throttling",internal:!1},PAN:{actions:B.assign({viewbox:function(e,t){return{minX:e.viewbox.minX+t.dx,minY:e.viewbox.minY+t.dy}}}),cond:function(e){return function(e){var t;return!(null!==(t=e.embed)&&void 0!==t&&t.isEmbedded)||e.embed.isEmbedded&&e.embed.pan}(e)},target:".throttling",internal:!1},"PAN.LEFT":{actions:B.assign({viewbox:function(e,t){return{minX:e.viewbox.minX-(t.isLongPan?50:10),minY:e.viewbox.minY}}}),target:".throttling",internal:!1},"PAN.RIGHT":{actions:B.assign({viewbox:function(e,t){return{minX:e.viewbox.minX+(t.isLongPan?50:10),minY:e.viewbox.minY}}}),target:".throttling",internal:!1},"PAN.UP":{actions:B.assign({viewbox:function(e,t){return{minX:e.viewbox.minX,minY:e.viewbox.minY-(t.isLongPan?50:10)}}}),target:".throttling",internal:!1},"PAN.DOWN":{actions:B.assign({viewbox:function(e,t){return{minX:e.viewbox.minX,minY:e.viewbox.minY+(t.isLongPan?50:10)}}}),target:".throttling",internal:!1},"POSITION.RESET":{actions:B.assign({zoom:B.initialContext.zoom,viewbox:B.initialContext.viewbox}),target:".throttling",internal:!1},SOURCE_CHANGED:{target:".throttling",internal:!1,actions:B.assign((function(e,t){var n;if(null===(n=e.embed)||void 0===n||!n.isEmbedded){var r=ee(t);return r||{}}return{}}))},"elkGraph.UPDATE":{actions:[B.assign({elkGraph:function(e,t){return t.elkGraph}}),(0,Z.lW)("FIT_TO_CONTENT")]},FIT_TO_CONTENT:{actions:[B.assign({zoom:function(e){return e.elkGraph?.9*Math.min(e.canvasPanelPosition.width/e.elkGraph.width,e.canvasPanelPosition.height/e.elkGraph.height,2):e.zoom}}),B.assign({viewbox:function(e){return e.elkGraph?{minX:e.elkGraph.width*e.zoom/2-e.canvasPanelPosition.width/2,minY:e.elkGraph.height*e.zoom/2-e.canvasPanelPosition.height/2}:e.viewbox}})]}},initial:"idle",states:{idle:{},throttling:{after:{300:"saving"},meta:{description:"\n          Throttling a moment before saving to ensure\n          we don't do too much saving to localStorage\n        "}},saving:{always:{actions:"persistPositionToLocalStorage",target:"idle"}}}}),ee=function(e){return"SOURCE_CHANGED"!==e.type?null:U.q.getPosition(e.id)},te=n(1338),ne=n(4679),re=n(9412),ie=n(9043);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=(0,G.createModel)({session:null,ref:null},{events:{DRAG_SESSION_STARTED:function(e){return{pointerId:e.pointerId,point:e.point}},DRAG_SESSION_STOPPED:function(){return{}},DRAG_POINT_MOVED:function(e){return{point:e.point}}}}),ce=se.createMachine({preserveActionOrder:!0,initial:"check_session_data",states:{check_session_data:{always:[{cond:function(e){return!!e.session},target:"active",actions:(0,Z.lj)((function(e){return se.events.DRAG_SESSION_STARTED(e.session)}))},"idle"]},idle:{invoke:{id:"dragSessionStartedListener",src:function(e){var t=e.ref;return function(e){var n=t.current,r=function(t){0===t.button&&e(se.events.DRAG_SESSION_STARTED({pointerId:t.pointerId,point:{x:t.pageX,y:t.pageY}}))};return n.addEventListener("pointerdown",r),function(){return n.removeEventListener("pointerdown",r)}}}},on:{DRAG_SESSION_STARTED:{target:"active",actions:ne.actions.forwardTo(ie.K.Parent)}}},active:{entry:["capturePointer","setSessionData"],exit:["releasePointer","clearSessionData"],invoke:{id:"dragSessionListeners",src:function(e){var t=e.ref,n=e.session;return function(e){var r=t.current,i=function(t){t.pointerId===n.pointerId&&e(se.events.DRAG_POINT_MOVED({point:{x:t.pageX,y:t.pageY}}))},o=function(t){t.pointerId===n.pointerId&&e(se.events.DRAG_SESSION_STOPPED())};return r.addEventListener("pointermove",i),r.addEventListener("pointerup",o),r.addEventListener("pointercancel",o),function(){r.removeEventListener("pointermove",i),r.removeEventListener("pointerup",o),r.removeEventListener("pointercancel",o)}}}},on:{DRAG_POINT_MOVED:{actions:["sendPointDelta","updatePoint"]},DRAG_SESSION_STOPPED:{target:"idle",actions:ne.actions.forwardTo(ie.K.Parent)}}}}},{actions:{capturePointer:function(e,t){var n=e.ref,r=e.session;return n.current.setPointerCapture(t.pointerId||(null===r||void 0===r?void 0:r.pointerId))},releasePointer:function(e){var t=e.ref,n=e.session;return t.current.releasePointerCapture(n.pointerId)},setSessionData:(0,Z.f0)({session:function(e,t){return"pointerId"in t&&t.point?{pointerId:t.pointerId,point:t.point}:e.session}}),clearSessionData:(0,Z.f0)({session:null}),updatePoint:(0,Z.f0)({session:function(e,t){return ae(ae({},e.session),{},{point:t.point})}}),sendPointDelta:(0,Z.lj)((function(e,t){return{type:"POINTER_MOVED_BY",delta:{x:t.point.x-e.session.point.x,y:t.point.y-e.session.point.y}}}))}});function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=(0,G.createModel)({ref:null},{events:{LOCK:function(){return{}},RELEASE:function(){return{}},ENABLE_PANNING:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{sessionSeed:e}},DISABLE_PANNING:function(){return{}},ENABLE_PAN_MODE:function(){return{}},DISABLE_PAN_MODE:function(){return{}},DRAG_SESSION_STARTED:function(e){return{point:e.point}},DRAG_SESSION_STOPPED:function(){return{}},POINTER_MOVED_BY:function(e){return{delta:e.delta}},WHEEL_PRESSED:function(e){return{data:e}},WHEEL_RELEASED:function(){return{}}}}),fe=ue.createMachine({preserveActionOrder:!0,initial:"checking_if_disabled",states:{checking_if_disabled:{always:[{target:"permanently_disabled",cond:"isPanDisabled"},"enabled"]},permanently_disabled:{},enabled:{type:"parallel",states:{mode:{initial:"lockable",states:{lockable:{initial:"released",states:{released:{invoke:[{src:"invokeDetectLock"},{src:"wheelPressListener"}],on:{LOCK:"locked",WHEEL_PRESSED:"wheelPressed"}},locked:{entry:ne.actions.raise(ue.events.ENABLE_PANNING()),exit:ne.actions.raise(ue.events.DISABLE_PANNING()),on:{RELEASE:"released"},invoke:{src:"invokeDetectRelease"}},wheelPressed:{entry:ne.actions.raise((function(e,t){return ue.events.ENABLE_PANNING(t.data)})),exit:ne.actions.raise(ue.events.DISABLE_PANNING()),on:{DRAG_SESSION_STOPPED:"released"}}},on:{ENABLE_PAN_MODE:"pan"}},pan:{entry:ne.actions.raise(ue.events.ENABLE_PANNING()),exit:ne.actions.raise(ue.events.DISABLE_PANNING()),on:{DISABLE_PAN_MODE:"lockable"}}}},panning:{initial:"disabled",states:{disabled:{on:{ENABLE_PANNING:"enabled"}},enabled:{entry:"disableTextSelection",exit:"enableTextSelection",invoke:{id:"dragSessionTracker",src:function(e,t){return ce.withContext(de(de({},se.initialContext),{},{ref:e.ref,session:"ENABLE_PANNING"===t.type?t.sessionSeed:t.data}))}},on:{DISABLE_PANNING:"disabled"},initial:"idle",states:{idle:{meta:{cursor:"grab"},on:{DRAG_SESSION_STARTED:"active"}},active:{initial:"grabbed",on:{DRAG_SESSION_STOPPED:".done"},states:{grabbed:{meta:{cursor:"grabbing"},on:{POINTER_MOVED_BY:{target:"dragging",actions:"sendPanChange"}}},dragging:{meta:{cursor:"grabbing"},on:{POINTER_MOVED_BY:{actions:"sendPanChange"}}},done:{type:"final"}},onDone:"idle"}}}}}}}}},{actions:{disableTextSelection:function(e){e.ref.current.style.userSelect="none"},enableTextSelection:function(e){e.ref.current.style.userSelect="unset"}},services:{wheelPressListener:function(e){return function(t){var n=e.ref.current,r=function(e){1===e.button&&t(ue.events.WHEEL_PRESSED({pointerId:e.pointerId,point:{x:e.pageX,y:e.pageY}}))};return n.addEventListener("pointerdown",r),function(){return n.removeEventListener("pointerdown",r)}}},invokeDetectLock:function(){return function(e){function t(t){var n=t.target;"Space"!==t.code||(0,b.nF)(n)||(t.preventDefault(),e("LOCK"))}return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}},invokeDetectRelease:function(){return function(e){function t(t){"Space"===t.code&&(t.preventDefault(),e("RELEASE"))}return window.addEventListener("keyup",t),function(){window.removeEventListener("keyup",t)}}}}}),he=function(e){var t;return null===(t=Object.values(e.meta).find((function(e){return Boolean(e.cursor)})))||void 0===t?void 0:t.cursor},pe=function(e){var t=e.children,n=e.panModeEnabled,a=P(),s=(0,re.b)(),c=(0,g.useRef)(null),l=(0,te.eO)(fe,{actions:{sendPanChange:ne.actions.send((function(e,t){return B.events.PAN(-t.delta.x,-t.delta.y)}),{to:a})},guards:{isPanDisabled:function(){return!(null===s||void 0===s||!s.isEmbedded)&&!s.pan}},context:de(de({},ue.initialContext),{},{ref:c})}),d=(0,o.Z)(l,2),u=d[0],f=d[1];return g.useEffect((function(){f(n?ue.events.ENABLE_PAN_MODE():ue.events.DISABLE_PAN_MODE())}),[n]),(0,g.useEffect)((function(){var e=new ResizeObserver((function(e){var t=e[0].target.getBoundingClientRect();a.send({type:"CANVAS_RECT_CHANGED",height:t.height,width:t.width,offsetX:t.left,offsetY:t.top})}));return e.observe(c.current),function(){e.disconnect()}}),[a]),(0,g.useEffect)((function(){function e(e){var t=e.target;if(!(0,b.J6)(t))switch(e.key){case"ArrowUp":if((0,b.CZ)(t))return;return e.preventDefault(),void a.send(B.events["PAN.DOWN"](e.shiftKey));case"ArrowLeft":if((0,b.CZ)(t))return;return e.preventDefault(),void a.send(B.events["PAN.RIGHT"](e.shiftKey));case"ArrowDown":if((0,b.CZ)(t))return;return e.preventDefault(),void a.send(B.events["PAN.UP"](e.shiftKey));case"ArrowRight":if((0,b.CZ)(t))return;return e.preventDefault(),void a.send(B.events["PAN.LEFT"](e.shiftKey));case"+":case"=":if((0,b.fl)(e))return;if(e.shiftKey)return;return e.preventDefault(),void a.send("ZOOM.IN");case"-":if((0,b.fl)(e))return;if(e.shiftKey)return;return e.preventDefault(),void a.send("ZOOM.OUT");case"1":case"!":if(!e.shiftKey)return;return e.preventDefault(),void a.send("FIT_TO_CONTENT")}}return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),(0,g.useEffect)((function(){var e=function(e){var t=!(null!==s&&void 0!==s&&s.isEmbedded)||s.zoom,n=!(null!==s&&void 0!==s&&s.isEmbedded)||s.pan;t&&(0,b.fl)(e)?(e.preventDefault(),e.deltaY>0?a.send(B.events["ZOOM.OUT"]({x:e.clientX,y:e.clientY},r.slow)):e.deltaY<0&&a.send(B.events["ZOOM.IN"]({x:e.clientX,y:e.clientY},r.slow))):!n||e.metaKey||e.ctrlKey||(e.preventDefault(),a.send(B.events.PAN(e.deltaX,e.deltaY)))},t=c.current;return t.addEventListener("wheel",e),function(){t.removeEventListener("wheel",e)}}),[a,s]),(0,i.jsx)("div",{ref:c,style:{cursor:he(u),WebkitFontSmoothing:"auto"},children:t})},ve=n(1475),ge=n(6617),xe=n(4115),ye=n(4390);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=function(e){return(0,i.jsx)("svg",je(je({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 683.4 236.6"},e),{},{children:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M202.4 136.9c5.6 4.7 12.1 7 19.9 7.2 9.1-.2 13.7-3.5 13.9-10 0-5.5-3-8.6-9.1-9.7-2.8-.4-6-.9-9.3-1.4-6-1.1-10.6-3.3-13.7-6.9-3.2-3.7-4.9-8.1-4.9-13.4 0-6.3 2.1-11.4 6.2-15.3 3.9-3.9 9.5-5.8 16.7-5.8 8.6.2 16.2 2.6 22.7 7.4l-6 9c-5.3-3.5-11.1-5.5-17.2-5.6-3.3 0-6 .9-8.1 2.5-2.3 1.8-3.5 4.4-3.5 7.7 0 2.1.7 4 2.3 5.6 1.6 1.8 4 3 7.6 3.5 1.9.4 4.6.7 7.9 1.1 6.5.9 11.4 3.3 14.6 7.2s4.6 8.3 4.6 13.5c-.5 14.2-8.6 21.1-24.6 21.3-10.4 0-19.2-3.3-26.7-9.8l6.7-8.1zM284 91.9h-19.2v-9.7h48.9v9.7h-19.2v62.4H284V91.9zM364.7 138.2h-26.6l-5.5 16.2h-11.3l25.3-72.1h8.8l25.3 72.1H370l-5.3-16.2zm-3-9.7l-10-31.5h-.2l-10.2 31.5h20.4zM407.3 91.9h-19.2v-9.7H437v9.7h-19.2v62.4h-10.6l.1-62.4zM458.4 82.2h44.7v10.2H469V113h29v9.7h-29V144h34.1v10.2h-44.7v-72zM528.4 82.2h10.9V144h35.2v10.3h-46.1V82.2zM601.9 124.7l-21.7-42.5h11.6l15.3 32 15.3-32H634l-21.7 42.5v29.7H602v-29.7z"}),(0,i.jsx)("circle",{transform:"rotate(-50.132 132.836 63.993)",cx:"132.8",cy:"64",r:"16"}),(0,i.jsx)("path",{d:"M83.9 50.8c-4.7 17-.3 35.9 13 49.2l10.1 10.4 20.5 20.5-21.8 21.8-21.8-21.8 16.9-16.9-18.3-18.2-35.1 35.1 58.3 58.3 58.3-58.3-80.1-80.1z"})]})}))},be=n(4155),Oe=function(e){return"".concat(be.env.NEXT_PUBLIC_REGISTRY_PUBLIC_URL,"/user/").concat(e)},we=function(e){return"".concat(be.env.NEXT_PUBLIC_REGISTRY_PUBLIC_URL,"/projects/").concat(e,"/edit")},Se=function(e){return"".concat(be.env.NEXT_PUBLIC_REGISTRY_PUBLIC_URL,"/machines/").concat(e,".png")},Pe=n(8928),Te=n(3733),De=n(2873),Ce=n(4860),Ie=n(6729),Re=n(6618),ke=n(8104),Ne=n(8134),Ae=n(17),_e=n(8448),ze=n(8119),Le=n(6640),Me=function(e){var t,n=e.children,r=(0,x.Z)(e,["children"]);return(0,i.jsx)(u.xu,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",position:"absolute",height:"100%",width:"100%",background:"blackAlpha.100",zIndex:null!==(t=r.zIndex)&&void 0!==t?t:1,children:n})},Ve=n(1428);function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue=function(e){var t=Array.from(e.elements).filter((function(e){return"fieldset"!==e.nodeName.toLowerCase()})).map((function(e){var t=e.getAttribute("name"),n=e.nodeName.toLowerCase();if(!t)throw Error("Form element with no name found in the form");switch(n){case"select":return{name:t,value:e.value};case"input":return{name:t,value:e.checked};default:throw Error("Unhandled input of type: "+e.nodeName)}}));return(0,b.pO)(t)},Fe=function(e){return'<iframe src="'.concat(e,'" sandbox="allow-same-origin allow-scripts"></iframe>')},Ye=(0,G.createModel)({loaded:!1,iframe:null,embedUrl:"",previewUrl:"",embedCode:Fe(""),params:{mode:Le.T.Viz,panel:Le.i.Code,readOnly:!0,showOriginalLink:!0,controls:!1,pan:!1,zoom:!1}},{events:{PARAMS_CHANGED:function(e){return{params:e}},PREVIEW:function(){return{}},IFRAME_READY:function(e){return{iframe:e}},IFRAME_LOADED:function(){return{}},IFRAME_ERROR:function(){return{}},RETRY:function(){return{}}}}),He=Ye.createMachine({id:"preview",type:"parallel",preserveActionOrder:!1,states:{form:{initial:"ready",states:{ready:{entry:["makeEmbedUrlAndCode",(0,Ve.pure)((function(e){if(!e.loaded)return{type:"makePreviewUrl"}})),"updateEmbedCopy",(0,Z.lW)("PREVIEW")],on:{PARAMS_CHANGED:{actions:["saveParams"],internal:!1,target:"ready"}}}}},iframe:{initial:"idle",on:{PREVIEW:[{cond:function(e){return e.loaded},target:".updating",internal:!1},".loading"],IFRAME_READY:{actions:[Ye.assign({iframe:function(e,t){return t.iframe}})]}},states:{idle:{},updating:{meta:{description:"Once iframe is loaded, we no longer change its `src` because that reloads the iframe window. Instead, we send the new url to its window using `postMessage`. That message will be picked up by `window.onmessage` listener that uses NextJS `router.pushState`"},entry:function(e){var t,n;null===(t=e.iframe)||void 0===t||null===(n=t.contentWindow)||void 0===n||n.postMessage({type:"EMBED_PARAMS_CHANGED",url:e.embedUrl.replace("/viz","")},"*")}},loading:{tags:"preview_loading",on:{IFRAME_LOADED:"loaded",IFRAME_ERROR:"error"}},loaded:{entry:Ye.assign({loaded:!0})},error:{tags:"preview_error",on:{RETRY:"loading"}}}}}}),Be=function(){var e=(0,v.useRouter)(),t=(0,g.useRef)(null),n=function(){var e=(0,g.useState)(""),t=e[0],n=e[1],r=(0,De.V)(t);return{copy:r.onCopy,setCopyText:n,isCopied:r.hasCopied}}(),r=n.copy,a=n.isCopied,s=n.setCopyText,c=(0,g.useRef)(null),l=(0,te.eO)(He,{actions:{saveParams:(0,Z.f0)({params:function(e,t){return t.params}}),updateEmbedCopy:function(e){s(e.embedCode)},makeEmbedUrlAndCode:(0,Z.f0)((function(t){var n=(0,b.WL)(e.query.sourceFileId,window.location.origin,t.params);return{embedUrl:n,embedCode:Fe(n),params:t.params}})),makePreviewUrl:(0,Z.f0)((function(t){return{previewUrl:(0,b.WL)(e.query.sourceFileId,window.location.origin,t.params)}}))}}),d=(0,o.Z)(l,2),f=d[0],h=d[1];(0,g.useEffect)((function(){h({type:"IFRAME_READY",iframe:c.current});var e=t.current;return function(){e.reset()}}),[]);var p=f.matches({form:"ready"}),x=f.hasTag("preview_loading"),y=f.hasTag("preview_error");return(0,i.jsxs)(u.xu,{display:"grid",gridTemplateAreas:'"sidebar preview"',gridTemplateColumns:"20rem 1fr","data-testid":"embed-preview",children:[(0,i.jsx)(u.xu,{gridArea:"sidebar",borderRight:"1px dotted var(--chakra-colors-black)",paddingRight:"2",opacity:p?1:.5,cursor:p?"default":"not-allowed",disabled:!p,children:(0,i.jsxs)(R.gC,{spacing:"10",justifyContent:"space-between",height:"100%",children:[(0,i.jsx)("form",{style:{width:"100%"},onChange:function(){h({type:"PARAMS_CHANGED",params:Ge(Ge({},b.uB),Ue(t.current))})},ref:t,children:(0,i.jsxs)(R.gC,{spacing:"5",children:[(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"mode",whiteSpace:"nowrap",children:"Mode"}),(0,i.jsx)(ke.Ph,{defaultValue:f.context.params.mode,id:"mode",name:"mode",size:"sm",width:"auto",children:Object.values(Le.T).map((function(e){return(0,i.jsx)("option",{value:e,children:e},e)}))})]}),f.context.params.mode!==Le.T.Viz&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"panel",whiteSpace:"nowrap",children:"Active Panel"}),(0,i.jsx)(ke.Ph,{defaultValue:f.context.params.panel,id:"panel",name:"panel",size:"sm",width:"auto",children:Object.values(Le.i).filter((function(e){return e!==Le.i.Settings})).map((function(e){return(0,i.jsx)("option",{value:e,children:e},e)}))})]}),(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"readOnly",whiteSpace:"nowrap",children:"Editor readonly"}),(0,i.jsx)(Ne.r,{defaultChecked:f.context.params.readOnly,id:"readOnly",name:"readOnly"})]}),(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"showOriginalLink",whiteSpace:"nowrap",children:"Show original link to visualizer"}),(0,i.jsx)(Ne.r,{defaultChecked:f.context.params.showOriginalLink,id:"showOriginalLink",name:"showOriginalLink"})]})]}),f.context.params.mode!==Le.T.Panels&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"controls",whiteSpace:"nowrap",children:"Show control buttons"}),(0,i.jsx)(Ne.r,{defaultChecked:f.context.params.controls,id:"controls",name:"controls"})]}),f.context.params.controls&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"pan",whiteSpace:"nowrap",children:"Allow panning"}),(0,i.jsx)(Ne.r,{defaultChecked:f.context.params.pan,id:"pan",name:"pan"})]}),(0,i.jsxs)(Ie.NI,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(Re.l,{marginBottom:"0",htmlFor:"zoom",whiteSpace:"nowrap",children:"Allow zooming"}),(0,i.jsx)(Ne.r,{defaultChecked:f.context.params.zoom,id:"zoom",name:"zoom"})]})]})]})]})}),(0,i.jsxs)(u.xu,{position:"relative",width:"100%",children:[(0,i.jsx)(_.z,{size:"xs",position:"absolute",rounded:"none",top:"0",right:"0",transform:"translateY(-110%)",onClick:r,children:a?"Copied":"Copy"}),(0,i.jsx)(Ae.g,{minHeight:"200px",readOnly:!0,value:f.context.embedCode,onClick:function(e){e.target.select(),r()}})]})]})}),(0,i.jsxs)(u.xu,{gridArea:"preview",paddingLeft:"2",display:"flex",placeContent:"center",children:[x&&(0,i.jsx)(Me,{children:(0,i.jsx)(k.$,{size:"lg"})}),y&&(0,i.jsxs)(R.gC,{justifyContent:"center",children:[(0,i.jsx)(_e.M,{color:"red.500",children:"Error loading preview"}),(0,i.jsx)(_.z,{onClick:function(){h("RETRY")},children:"Retry"})]}),!y&&(0,i.jsx)(u.xu,{position:"relative",width:"100%",height:"0",paddingTop:"56.25%",children:(0,i.jsx)("iframe",{ref:c,style:{position:"absolute",height:x?0:"100%",left:0,right:0,top:0,bottom:0,width:"100%"},onLoad:function(e){var t;null!==(t=e.target.contentWindow)&&void 0!==t&&t.length?h("IFRAME_LOADED"):h("IFRAME_ERROR")},src:f.context.previewUrl})})]})]})},We=function(e){var t=e.isOpen,n=e.onClose;return(0,i.jsxs)(ze.u_,{size:"6xl",isOpen:t,onClose:n,children:[(0,i.jsx)(ze.ZA,{}),(0,i.jsx)(ze.hz,{children:(0,i.jsx)(ze.fe,{children:(0,i.jsx)(Be,{})})})]})},Ke=n(58);function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Je=function(e,t){return function(n){return(0,i.jsx)(Ke.J,qe(qe(qe({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),n),{},{children:e}))}},$e=(Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0 0h24v24H0V0zm0 0h24v24H0V0z",fill:"none"}),(0,i.jsx)("path",{d:"M9 21h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.58 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2zM9 9l4.34-4.34L12 10h9v2l-3 7H9V9zM1 9h4v12H1z"})]})),Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,i.jsx)("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"})]})),Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,i.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"})]})),Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,i.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})]})),Je((0,i.jsx)("path",{d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"}))),Qe=Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("g",{children:(0,i.jsx)("rect",{fill:"none",height:"24",width:"24",x:"0"})}),(0,i.jsx)("g",{children:(0,i.jsxs)("g",{children:[(0,i.jsx)("polygon",{points:"20,7 20.94,4.94 23,4 20.94,3.06 20,1 19.06,3.06 17,4 19.06,4.94"}),(0,i.jsx)("polygon",{points:"8.5,7 9.44,4.94 11.5,4 9.44,3.06 8.5,1 7.56,3.06 5.5,4 7.56,4.94"}),(0,i.jsx)("polygon",{points:"20,12.5 19.06,14.56 17,15.5 19.06,16.44 20,18.5 20.94,16.44 23,15.5 20.94,14.56"}),(0,i.jsx)("path",{d:"M17.71,9.12l-2.83-2.83C14.68,6.1,14.43,6,14.17,6c-0.26,0-0.51,0.1-0.71,0.29L2.29,17.46c-0.39,0.39-0.39,1.02,0,1.41 l2.83,2.83C5.32,21.9,5.57,22,5.83,22s0.51-0.1,0.71-0.29l11.17-11.17C18.1,10.15,18.1,9.51,17.71,9.12z M14.17,8.42l1.41,1.41 L14.41,11L13,9.59L14.17,8.42z M5.83,19.59l-1.41-1.41L11.59,11L13,12.41L5.83,19.59z"})]})})]}),{fill:"current"}),et=Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,i.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"})]})),tt=Je((0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M458.7,81.1L458.7,81.1c0-44.8-36.3-81.1-81.1-81.1c-44.8,0-81.1,36.3-81.1,81.1c0,40.3,29.3,73.7,67.8,80l0.5,0.1v37.3 c0,28.3-22.9,51.2-51.2,51.2H151.5v-89.3c36.8-8.1,64-40.5,64-79.3c0-44.8-36.3-81.1-81.1-81.1C89.6,0,53.3,36.3,53.3,81.1 c0,38.7,27.2,71.1,63.5,79.1l0.5,0.1v191.4c-36.8,8.1-64,40.5-64,79.3c0,44.8,36.3,81.1,81.1,81.1c44.8,0,81.1-36.3,81.1-81.1 c0-38.7-27.1-71.1-63.5-79.1l-0.6-0.1v-67.9h162.1c47.1-0.1,85.3-38.2,85.3-85.3v-39.1C433.6,149.5,458.6,118.3,458.7,81.1 L458.7,81.1z M87.5,81.1c0-25.9,21-46.9,46.9-46.9c25.9,0,46.9,21,46.9,46.9c0,25.9-21,46.9-46.9,46.9 C108.5,128,87.5,107,87.5,81.1L87.5,81.1z M181.3,430.9c0,25.9-21,46.9-47,46.9c-25.9,0-46.9-21-46.9-46.9 c0-25.9,21-46.9,46.9-46.9C160.3,384,181.3,405,181.3,430.9L181.3,430.9z M377.6,128c-25.9,0-47-21-47-46.9s21-46.9,47-46.9 c25.9,0,46.9,21,46.9,46.9C424.5,107,403.5,128,377.6,128L377.6,128z"})}),{viewBox:"0 0 512 512"}),nt=Je((0,i.jsx)("g",{children:(0,i.jsx)("path",{fill:"currentColor",d:"M436 192H312c-13.3 0-24-10.7-24-24V44c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v84h84c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm-276-24V44c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v84H12c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24zm0 300V344c0-13.3-10.7-24-24-24H12c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-84h84c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12H312c-13.3 0-24 10.7-24 24v124c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12z"})}),{viewBox:"0 0 448 512"}),rt=Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,i.jsx)("path",{d:"M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"})]}),{fill:"current"}),it=Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("g",{children:(0,i.jsx)("rect",{fill:"none",height:"24",width:"24"})}),(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M11,21h-1l1-7H7.5c-0.88,0-0.33-0.75-0.31-0.78C8.48,10.94,10.42,7.54,13.01,3h1l-1,7h3.51c0.4,0,0.62,0.19,0.4,0.66 C12.97,17.55,11,21,11,21z"})})]}),{fill:"current"}),ot=Je((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{style:{fill:"#fff"},d:"M20,44c-0.256,0-0.512-0.098-0.707-0.293L4.586,29l14.707-14.707c0.391-0.391,1.023-0.391,1.414,0 s0.391,1.023,0,1.414L7.414,29l13.293,13.293c0.391,0.391,0.391,1.023,0,1.414C20.512,43.902,20.256,44,20,44z"}),(0,i.jsx)("path",{style:{fill:"#fff"},d:"M37,44c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414L49.586,29L36.293,15.707 c-0.391-0.391-0.391-1.023,0-1.414s1.023-0.391,1.414,0L52.414,29L37.707,43.707C37.512,43.902,37.256,44,37,44z"}),(0,i.jsx)("path",{style:{fill:"#fff"},d:"M24.001,50c-0.071,0-0.144-0.008-0.216-0.023c-0.539-0.118-0.88-0.651-0.762-1.191l9-41 c0.118-0.539,0.654-0.88,1.191-0.762c0.539,0.118,0.88,0.651,0.762,1.191l-9,41C24.874,49.682,24.46,50,24.001,50z"})]}),{viewBox:"0 0 55 55"}),at=Je((0,i.jsx)("path",{d:"M18 24h-6.55c-1.08 0-2.14-.45-2.89-1.23l-7.3-7.61 2.07-1.83c.62-.55 1.53-.66 2.26-.27L8 14.34V4.79c0-1.38 1.12-2.5 2.5-2.5.17 0 .34.02.51.05.09-1.3 1.17-2.33 2.49-2.33.86 0 1.61.43 2.06 1.09.29-.12.61-.18.94-.18 1.38 0 2.5 1.12 2.5 2.5v.28c.16-.03.33-.05.5-.05 1.38 0 2.5 1.12 2.5 2.5V20c0 2.21-1.79 4-4 4zM4.14 15.28l5.86 6.1c.38.39.9.62 1.44.62H18c1.1 0 2-.9 2-2V6.15c0-.28-.22-.5-.5-.5s-.5.22-.5.5V12h-2V3.42c0-.28-.22-.5-.5-.5s-.5.22-.5.5V12h-2V2.51c0-.28-.22-.5-.5-.5s-.5.22-.5.5V12h-2V4.79c0-.28-.22-.5-.5-.5s-.5.23-.5.5v12.87l-5.35-2.83-.51.45z"}),{fill:"current"}),st=(0,G.createModel)({},{events:{COPY_LINK:function(){return{}}}}).createMachine({id:"shareMachine",on:{COPY_LINK:{target:".pending"}},initial:"notCopied",states:{notCopied:{},pending:{tags:["loading"],meta:{description:"\n          A fake pending state to give the user\n          some visual feedback\n        "},after:{250:{target:"copied"}}},copied:{entry:["copyLinkToClipboard"],tags:"copied",after:{2e3:{target:"notCopied"}}}}}),ct=function(e){var t=(0,De.V)(e),n=(0,te.eO)(st,{actions:{copyLinkToClipboard:function(){t.onCopy()}}}),r=(0,o.Z)(n,2),i=r[0],a=r[1];return{onClickCopy:function(){return a("COPY_LINK")},isLoading:i.hasTag("loading"),hasCopied:i.hasTag("copied")}},lt=function(e){var t=e.sourceId,n=(0,Ce.q)(),r=n.isOpen,o=n.onClose,a=n.onOpen,s=window.location.href,c="Check out the state machine I built in the @statelyai visualizer: ".concat(s),l=ct(s),d=ct(Se(t));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(z.v2,{children:[(0,i.jsx)(z.j2,{size:"sm",leftIcon:(0,i.jsx)(Pe.h,{}),as:_.z,children:"Share"}),(0,i.jsxs)(z.qy,{children:[(0,i.jsx)(z.sN,{onClick:l.onClickCopy,children:(0,i.jsxs)(R.Ug,{spacing:"3",children:[l.isLoading?(0,i.jsx)(k.$,{size:"xs"}):(0,i.jsx)(Te.T,{}),(0,i.jsx)(xe.x,{children:l.hasCopied?"Link copied!":l.isLoading?"Copying...":"Copy link"})]})}),(0,i.jsx)(z.sN,{href:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(c)),as:M.r,target:"_blank",rel:"noopener noreferrer",_hover:{textDecoration:"none"},children:(0,i.jsxs)(R.Ug,{spacing:"3",children:[(0,i.jsx)($e,{fill:"white"}),(0,i.jsx)(xe.x,{children:"Twitter"})]})}),m&&(0,i.jsx)(z.sN,{onClick:d.onClickCopy,children:(0,i.jsxs)(R.Ug,{spacing:"3",children:[d.isLoading?(0,i.jsx)(k.$,{size:"xs"}):(0,i.jsx)(Te.T,{}),(0,i.jsx)(xe.x,{children:d.hasCopied?"Link copied!":d.isLoading?"Copying...":"Copy Image URL"})]})}),(0,i.jsx)(z.sN,{onClick:a,children:(0,i.jsxs)(R.Ug,{spacing:"3",children:[(0,i.jsx)(ot,{fill:"white"}),(0,i.jsx)(xe.x,{children:"Embed"})]})})]})]}),(0,i.jsx)(We,{isOpen:r,onClose:o})]})},dt=n(4861),ut=function(){var e,t,n,r,a,s,c,l,d,u,f,h,p,v,g=(0,dt.CN)(),x=(0,o.Z)(g,1)[0],y=(0,E.pL)(),m=x.context.sourceRegistryData,j=(null===y||void 0===y?void 0:y.id)===(null===m||void 0===m||null===(e=m.project)||void 0===e||null===(t=e.owner)||void 0===t?void 0:t.id);return(0,i.jsxs)(R.Ug,{zIndex:1,justifyContent:"space-between",height:"3rem",children:[(0,i.jsx)(M.r,{href:"/",title:"Stately.ai",display:"block",height:"100%",_hover:{opacity:.8},target:"_blank",rel:"noreferrer",className:"plausible-event-name=viz+stately-logo",children:(0,i.jsx)(Ee,{fill:"white",style:{"--fill":"white",height:"100%",padding:"0 .5rem"},"aria-label":"Stately"})}),m&&(0,i.jsxs)(R.Kq,{direction:"row",spacing:"4",alignItems:"center",pr:"4",children:[(0,i.jsx)(xe.x,{fontWeight:"semibold",fontSize:"sm",color:"gray.100",children:(null===m||void 0===m||null===(n=m.project)||void 0===n?void 0:n.name)||"Unnamed Source"}),(0,i.jsxs)(R.Ug,{children:[(0,i.jsx)(lt,{sourceId:m.id}),(0,i.jsxs)(z.v2,{closeOnSelect:!0,children:[(0,i.jsx)(z.j2,{as:A.h,"aria-label":"Menu",icon:(0,i.jsx)(ve.U,{}),size:"sm"}),(0,i.jsxs)(z.qy,{children:[j&&(null===(r=x.context.sourceRegistryData)||void 0===r||null===(a=r.project)||void 0===a?void 0:a.id)&&(0,i.jsx)(z.sN,{as:"a",href:we(null===(s=x.context.sourceRegistryData)||void 0===s||null===(c=s.project)||void 0===c?void 0:c.id),children:(0,i.jsxs)(R.Ug,{spacing:"3",children:[(0,i.jsx)(ge.d,{}),(0,i.jsx)(xe.x,{children:"Edit"})]})}),(null===(l=m.project)||void 0===l?void 0:l.owner)&&(0,i.jsx)(z.sN,{as:"a",href:Oe(null===m||void 0===m||null===(d=m.project)||void 0===d||null===(u=d.owner)||void 0===u?void 0:u.id),children:(0,i.jsxs)(R.Ug,{spacing:"3",children:[(0,i.jsx)(ye.qE,{src:(null===(f=m.project)||void 0===f||null===(h=f.owner)||void 0===h?void 0:h.avatarUrl)||"",name:(null===(p=m.project)||void 0===p||null===(v=p.owner)||void 0===v?void 0:v.displayName)||"",size:"xs",height:"24px",width:"24px"}),(0,i.jsx)(xe.x,{children:"View Author"})]})})]})]})]})]})]})},ft=n(8216),ht=n(5997),pt=n(509),vt=function(){function e(t,n){var r=this;(0,ft.Z)(this,e),this.parent=n,(0,l.Z)(this,"id",void 0),(0,l.Z)(this,"data",void 0),(0,l.Z)(this,"children",void 0),(0,l.Z)(this,"ports",void 0),(0,l.Z)(this,"edges",void 0),(0,l.Z)(this,"layout",void 0),this.id=t.id,this.data=t.stateNode,this.children=t.children,this.children.forEach((function(e){e.parent=r})),this.ports=t.ports,this.edges=t.edges.map((function(e){return new gt(e)}))}return(0,ht.Z)(e,[{key:"absolute",get:function(){return this.parent?this.layout?{x:this.layout.x+this.parent.absolute.x,y:this.layout.y+this.parent.absolute.y}:void 0:this.layout}}]),(0,ht.Z)(e,[{key:"level",get:function(){var e,t;return(null!==(e=null===(t=this.parent)||void 0===t?void 0:t.level)&&void 0!==e?e:-1)+1}}]),e}(),gt=function e(t){(0,ft.Z)(this,e),(0,l.Z)(this,"id",void 0),(0,l.Z)(this,"source",void 0),(0,l.Z)(this,"target",void 0),(0,l.Z)(this,"label",void 0),(0,l.Z)(this,"transition",void 0),(0,l.Z)(this,"sections",void 0),this.id=t.id,this.source=t.source,this.target=t.target,this.label=t.label,this.transition=t.transition,this.sections=t.sections};function xt(e){var t=(0,pt.flatten)(e.transitions.map((function(t,n){return(t.target?t.target:[e]).map((function(r,i){return new gt({id:"".concat(e.id,":").concat(n,":").concat(i),source:e,target:r,transition:t,label:{text:t.eventType,x:0,y:0},sections:[]})}))})));return new vt({id:e.id,stateNode:e,children:(0,b.G)(e).map((function(e){return xt(e)})),edges:t,ports:[]})}function yt(e){return e.children.length?[e].concat(e.children.map(yt).flat()):[e]}function mt(e){var t=yt(e),n=new Map;return t.forEach((function(e){e.edges.forEach((function(e){!function(e,t){n.get(e)||n.set(e,new Set),n.get(e).add(t)}(e.target,e)}))})),n}var jt,Et=n(4801),bt=n(7120);function Ot(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function St(e){var t=new Set,n=[];return e.forEach((function(r,i){var o=e[i-1],a=e[i+1];if(((null===o||void 0===o?void 0:o.x)!==r.x||r.x!==(null===a||void 0===a?void 0:a.x))&&((null===o||void 0===o?void 0:o.y)!==r.y||r.y!==(null===a||void 0===a?void 0:a.y))){var s="".concat(r.x,"|").concat(r.y);t.has(s)||n.push(r)}})),n}function Pt(e){var t=[];return e.forEach((function(n,r){var i=[n,e[r+1],e[r+2]],o=i[0],a=i[1];if(i[2]&&a){var s={x:o.x+(a.x-o.x)/2,y:o.y+(a.y-o.y)/2,color:"green",label:"midpoint"};t.push(o,s)}else t.push(o)})),t}function Tt(e,t,n){return!(e.x===t.x&&n.x===t.x||e.y===t.y&&n.y===t.y)}!function(e){e.Top="top",e.Right="right",e.Bottom="bottom",e.Left="left"}(jt||(jt={}));var Dt=function(e,t){return{type:"vector",x:t.x-e.x,y:t.y-e.y}},Ct=function(e){var t=e.x*e.x+e.y*e.y;return t=Math.sqrt(t),{type:"vector",x:e.x/t,y:e.y/t}},It=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,i=Dt(t,e),o=Dt(t,n),a=Math.hypot(i.x,i.y),s=Math.hypot(o.x,o.y);if(a*s===0)return{p1:t,p2:t,p:t};var c=Math.min(r,a-.1,s-.1),l=Ct(i),d=Ct(o),u={x:t.x+l.x*c,y:t.y+l.y*c},f={x:t.x+d.x*c,y:t.y+d.y*c},h={p1:u,p2:f,p:t};return h};function Rt(e){return e.map((function(e){var t=(0,bt.Z)(e),n=t[0],r=t.slice(1);return[n].concat((0,Et.Z)(r.map((function(e){return"".concat(e.x,",").concat(e.y)})))).join(" ")})).join(" ")}function kt(e){var t,n=[],r=[],i=[],a=Ot(e);try{for(a.s();!(t=a.n()).done;){var s=t.value,c=(0,o.Z)(s,1)[0];"L"!==c&&i.length>1&&(n.push([].concat(i)),i.length=0),("M"===c||"L"===c)&&i.push(s)}}catch(f){a.e(f)}finally{a.f()}i.length>1&&n.push([].concat(i));for(var l=function(){var e=u[d],t=Pt(St(e.map((function(e){return(0,o.Z)(e,2)[1]})))),n=[e[0]];t.forEach((function(e,t,r){if(t>=2&&t<=r.length-2&&Tt(r[t-1],e,r[t+1])){var i=It(r[t-1],e,r[t+1],10),o=i.p1,a=i.p2,s=i.p;n.push(["L",o],["C",o,s,a])}else n.push(["L",e])})),r.push.apply(r,n)},d=0,u=n;d<u.length;d++)l();return r}var Nt=function(e){var t=e.id;return(0,i.jsx)("marker",{id:t,viewBox:"0 0 10 10",markerWidth:"5",markerHeight:"5",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto",children:(0,i.jsx)("path",{d:"M0,0 L0,10 L10,5 z","data-viz":"edge-arrow"})})},At=(0,b.Fx)("Simulation"),_t=(0,o.Z)(At,3),zt=_t[0],Lt=_t[1],Mt=(0,_t[2])((function(e){return e.hasTag("inspecting")?"inspecting":"visualizing"}));var Vt,Zt=function(e){var t,n=e.edge,r=e.order,o=Lt(),a=(0,h.v)(o,(function(e){var t;return null===(t=e.context.serviceDataMap[e.context.currentSessionId])||void 0===t?void 0:t.state.configuration.includes(n.source)}));if(n.sections.length){var s,c=n.sections[0],l=(t=[["M",c.startPoint]].concat((0,Et.Z)((null===(s=c.bendPoints)||void 0===s?void 0:s.map((function(e){return["L",e]})))||[])))[t.length-1][1],d=Math.sign(c.endPoint.x-l.x),u=Math.sign(c.endPoint.y-l.y),f={x:c.endPoint.x-5*d,y:c.endPoint.y-5*u};t.push(["L",f])}var p="".concat(n.source.order,"-").concat(r);return t?(0,i.jsxs)("g",{"data-viz":"edgeGroup","data-viz-edge":n.id,"data-viz-active":a||void 0,children:[(0,i.jsx)("defs",{children:(0,i.jsx)(Nt,{id:p})}),(0,i.jsx)("path",{stroke:"#fff4",strokeWidth:2,fill:"none",d:Rt(kt(t)),"data-viz":"edge",markerEnd:"url(#".concat(p,")")})]}):null};function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e){var t=[];return function e(n){t.push.apply(t,(0,Et.Z)(n.edges)),n.children.forEach(e)}(e),t}function Yt(e){var t=Ft(e),n=new Map,r=new Map;return t.forEach((function(e){var t=function(e){var t=e.source,n=e.target;if(t===n)return t.parent;for(var r=new Set([t]),i=t.parent;i;)r.add(i),i=i.parent;for(i=n;i;){if(r.has(i))return i;i=i.parent}return t.machine}(e);n.has(t)||n.set(t,[]),n.get(t).push(e),r.set(e.id,t)})),[n,r]}function Ht(e,t){var n,r=t.get(e.id),i=Bt(e),o=e.source===e.target,a=(null===(n=e.source.parent)||void 0===n?void 0:n.initial)===e.source.key,s=[e.source.id],c=o?[Wt(e.target.id)]:[i];return{id:e.id,sources:s,targets:c,labels:[{id:"label:"+e.id,width:r.width,height:r.height,text:e.label.text||"always",layoutOptions:{"edgeLabels.inline":o?"false":"true","edgeLabels.placement":"CENTER","edgeLabels.centerLabelPlacementStrategy":"TAIL_LAYER"}}],edge:e,sections:[],layoutOptions:{"elk.layered.priority.direction":a?"1":"0"}}}function Bt(e){return"port:".concat(e.id)}function Wt(e){return"self:".concat(e)}"undefined"!==typeof ELK&&(Vt=new ELK);var Kt=function(e){return new Promise((function(e){var t=new Map,n=setInterval((function(){document.querySelector('[data-viz="machine"]')&&(document.querySelectorAll("[data-rect-id]").forEach((function(e){var n=e.dataset.rectId,r=e.getBoundingClientRect();t.set(n,r)})),clearInterval(n),e(t))}),100)}))};function Xt(e){return e.children.length?Math.max.apply(Math,(0,Et.Z)(e.children.map((function(e){return Xt(e)})))):e.level}function qt(e,t){var n,r=t.relativeNodeEdgeMap,i=t.backLinkMap,o=t.rectMap,a=o.get(e.id),s=o.get("".concat(e.id,":content")),c=r[0].get(e.data)||[],l=Array.from(null!==(n=i.get(e.data))&&void 0!==n?n:[]),d=l.some((function(e){return e.source===e.target})),u=t.attempt<2&&Xt(e)>e.level+1,f=u&&0===t.attempt;return Ut(Ut({id:e.id},e.children.length?void 0:{width:a.width,height:a.height}),{},{node:e,children:Jt(e,t),absolutePosition:{x:0,y:0},edges:c.map((function(e){return Ht(e,o)})),ports:l.map((function(e){return{id:Bt(e),width:5,height:5,layoutOptions:{}}})).concat(d?[{id:Wt(e.id),width:5,height:5,layoutOptions:{}}]:[]),layoutOptions:Ut({"elk.padding":"[top=".concat(s.height+30,", left=30, right=30, bottom=30]"),"elk.spacing.labelLabel":"10"},u&&Ut({"elk.aspectRatio":"2","elk.layered.wrapping.strategy":"SINGLE_EDGE"},f&&{"elk.layered.compaction.postCompaction.strategy":"LEFT"}))})}function Jt(e,t){return e.children.map((function(e){return qt(e,t)}))}function $t(e){return"absolutePosition"in e}function Qt(){return(Qt=(0,c.Z)(s().mark((function e(t){var n,r,i,o,a,c,l,d,u,f,h,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kt(t.id);case 2:r=e.sent,i=Yt(t),o=mt(t),a=i[0].get(void 0)||[],c={attempt:0,relativeNodeEdgeMap:i,backLinkMap:o,rectMap:r},l=function(e){return{id:"root",edges:a.map((function(e){return Ht(e,r)})),children:[qt(t,e)],layoutOptions:{"elk.hierarchyHandling":"INCLUDE_CHILDREN","elk.algorithm":"layered","elk.layered.considerModelOrder":"NODES_AND_EDGES","elk.layered.wrapping.strategy":"MULTI_EDGE","elk.aspectRatio":"2","elk.direction":"DOWN"}}},d=void 0;case 9:if(!(c.attempt<=2)||d){e.next=22;break}return e.prev=10,e.next=13,Vt.layout(l(c));case 13:d=e.sent,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(10),console.error(e.t0),c.attempt+=1;case 20:e.next=9;break;case 22:if(d){e.next=24;break}throw new Error("Unable to layout ELK node.");case 24:return u=new Map,f=function(e){var t,n,r=i[1].get(e.id),o=r&&u.get(r),a=o?e.sections.map((function(e){var t,n;return Ut(Ut({},e),{},{startPoint:{x:e.startPoint.x+o.absolutePosition.x,y:e.startPoint.y+o.absolutePosition.y},endPoint:{x:e.endPoint.x+o.absolutePosition.x,y:e.endPoint.y+o.absolutePosition.y},bendPoints:null!==(t=null===(n=e.bendPoints)||void 0===n?void 0:n.map((function(e){return{x:e.x+o.absolutePosition.x,y:e.y+o.absolutePosition.y}})))&&void 0!==t?t:[]})})):e.sections;e.edge.sections=a,e.edge.label.x=((null===(t=e.labels)||void 0===t?void 0:t[0].x)||0)+((null===o||void 0===o?void 0:o.absolutePosition.x)||0),e.edge.label.y=((null===(n=e.labels)||void 0===n?void 0:n[0].y)||0)+((null===o||void 0===o?void 0:o.absolutePosition.y)||0)},h=function e(t,n){var r,i,o,a;u.set(t.node.data,t),t.absolutePosition={x:(null!==(r=null===n||void 0===n?void 0:n.absolutePosition.x)&&void 0!==r?r:0)+t.x,y:(null!==(i=null===n||void 0===n?void 0:n.absolutePosition.y)&&void 0!==i?i:0)+t.y},t.node.layout={width:t.width,height:t.height,x:t.x,y:t.y},null===(o=t.edges)||void 0===o||o.forEach((function(e){f(e)})),null===(a=t.children)||void 0===a||a.forEach((function(n){$t(n)&&e(n,t)}))},null===(n=d.edges)||void 0===n||n.forEach(f),p=d.children[0],h(p,void 0),e.abrupt("return",d);case 31:case"end":return e.stop()}}),e,null,[[10,16]])})))).apply(this,arguments)}var en=function(e){var t=e.node,n=Lt(),r=(0,h.v)(n,(function(e){var n;return null===(n=e.context.serviceDataMap[e.context.currentSessionId])||void 0===n?void 0:n.state.configuration.includes(t.data)}));if(!t.absolute)return null;var o={x:t.absolute.x-10,y:t.absolute.y+10},a={x:o.x-5,y:o.y-10},s="n".concat(Math.floor(1e3*Math.random()));return(0,i.jsxs)("g",{"data-viz":"edgeGroup","data-viz-active":r||void 0,children:[(0,i.jsx)("defs",{children:(0,i.jsx)(Nt,{id:s})}),(0,i.jsx)("circle",{"data-viz":"initialEdge-circle",r:"4",cx:a.x,cy:a.y,fill:"var(--stroke)"}),(0,i.jsx)("path",{"data-viz":"edge",d:"M ".concat(a.x,",").concat(a.y," Q ").concat(a.x,",").concat(o.y," ").concat(o.x,",").concat(o.y," L ").concat(o.x+1,", ").concat(o.y),stroke:"var(--stroke)",strokeWidth:2,fill:"none",markerEnd:"url(#".concat(s,")"),pathLength:1})]})};function tn(e){var t,n=[];return(null===(t=e.data.parent)||void 0===t?void 0:t.initial)===e.data.key&&n.push(e),e.children.forEach((function(e){n.push.apply(n,(0,Et.Z)(tn(e)))})),n}var nn=function(e){var t=e.digraph,n=Ft(t),r=tn(t);return(0,i.jsxs)("svg",{style:{position:"absolute",height:"100vh",width:"100vw",top:0,left:0,pointerEvents:"none",overflow:"visible"},children:[r.map((function(e){return(0,i.jsx)(en,{node:e},e.id)})),n.map((function(e,t){return(0,i.jsx)(Zt,{edge:e,order:t},e.id)}))]})},rn=n(5206),on=n.n(rn);var an=function(e){var t=e.children,n=e.title,r=(0,g.useRef)(null),o=(0,g.useState)(n||""),a=o[0],s=o[1];return(0,g.useEffect)((function(){r.current&&!n&&s(r.current.textContent)}),[n]),(0,i.jsx)("div",{"data-viz":"action-type",title:a,ref:r,children:t})},sn=function(e){var t,n=e.action,r="object"===typeof n.event&&null!==n.event?null!==(t=n.event.type)&&void 0!==t?t:(0,i.jsx)("em",{children:"unknown"}):"".concat(n.event);return(0,i.jsxs)(an,{children:[(0,i.jsx)("strong",{children:"raise"})," ",r]})},cn=function(e){var t=e.action;if(!t.event)return(0,i.jsxs)(an,{children:[(0,i.jsx)("strong",{children:"send"})," ",(0,i.jsx)("em",{children:"unknown"})]});var n="xstate.update"===t.event.type?(0,i.jsx)("strong",{children:"send update"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("strong",{children:"send"})," ",t.event.type]}),r=t.to?t.to===ie.K.Parent?(0,i.jsxs)(i.Fragment,{children:["to ",(0,i.jsx)("em",{children:"parent"})]}):(0,i.jsxs)(i.Fragment,{children:["to ",t.to]}):"";return(0,i.jsxs)(an,{children:[n," ",r]})},ln=function(e){var t=e.action;return(0,i.jsxs)(an,{children:[(0,i.jsx)("strong",{children:"log"})," ",t.label]})},dn=function(e){var t=e.action;return(0,i.jsxs)(an,{children:[(0,i.jsx)("strong",{children:"cancel"})," ",t.sendId]})},un=function(e){var t=e.action;return(0,i.jsxs)(an,{children:[(0,i.jsx)("strong",{children:"stop"})," ","object"===typeof t.activity&&"id"in t.activity?t.activity.id:(0,i.jsx)("em",{children:"expr"})]})},fn=function(e){var t,n=e.action;return(0,i.jsxs)(an,{children:[(0,i.jsx)("strong",{children:"assign"})," ","object"===typeof n.assignment?Object.keys(n.assignment).join(", "):(0,i.jsx)("em",{children:(null===(t=n.assignment)||void 0===t?void 0:t.name)||"expr"})]})},hn=function(){return(0,i.jsx)(an,{children:(0,i.jsx)("strong",{children:"choose"})})},pn=function(e){var t=function(e){return e?"function"===typeof e.exec?(0,b.Kb)(e.type)?"anonymous":e.type:e.type?e.type.startsWith("xstate.")?e.type.match(/^xstate\.(.+)$/)[1]:e.type:null:null}(e.action);return null===t?null:(0,i.jsx)(an,{children:"anonymous"===t?(0,i.jsx)("em",{children:"anonymous"}):(0,i.jsx)("strong",{children:t})})},vn=function(e){var t,n,r=e.action,o=e.kind;if((0,b.Sp)(r))return null;var a=null!==(t=(n={},(0,l.Z)(n,ie.M.Assign,(0,i.jsx)(fn,{action:r})),(0,l.Z)(n,ie.M.Raise,(0,i.jsx)(sn,{action:r})),(0,l.Z)(n,ie.M.Send,(0,i.jsx)(cn,{action:r})),(0,l.Z)(n,ie.M.Log,(0,i.jsx)(ln,{action:r})),(0,l.Z)(n,ie.M.Cancel,(0,i.jsx)(dn,{action:r})),(0,l.Z)(n,ie.M.Stop,(0,i.jsx)(un,{action:r})),(0,l.Z)(n,ie.M.Choose,(0,i.jsx)(hn,{action:r})),n)[r.type])&&void 0!==t?t:(0,i.jsx)(pn,{action:r});return(0,i.jsx)("div",{"data-viz":"action","data-viz-action":o,children:a})};function gn(e){return"number"!==typeof e&&isNaN(+e)?e:"".concat(e,"ms")}function xn(e){if(yn(e)){var t=e.match(/:invocation\[(\d+)\]$/);if(!t)return e;var n=(0,o.Z)(t,2)[1];return"anonymous [".concat(n,"]")}return e}function yn(e){return/:invocation\[/.test(e)}function mn(e){var t=e.invoke,n=yn(t.id),r="string"===typeof t.src?t.src:t.src.type,o=n?"anonymous":t.id;return(0,i.jsx)("div",{"data-viz":"action","data-viz-action":"invoke",title:"".concat(o," (").concat(r,")"),children:(0,i.jsx)("div",{"data-viz":"action-type",children:n?(0,i.jsx)("em",{children:o}):o})})}var jn=function(e){var t=e.eventType,n=e.delay;e.onChangeEventType;if(t.startsWith("done.state."))return(0,i.jsx)("div",{"data-viz":"eventType","data-viz-keyword":"done",children:(0,i.jsx)("em",{"data-viz":"eventType-keyword",children:"onDone"})});if(t.startsWith("done.invoke.")){var r=t.match(/^done\.invoke\.(.+)$/);return(0,i.jsxs)("div",{"data-viz":"eventType","data-viz-keyword":"done",children:[(0,i.jsx)("em",{"data-viz":"eventType-keyword",children:"done:"})," ",(0,i.jsx)("div",{"data-viz":"eventType-text",children:r?xn(r[1]):"??"})]})}if(t.startsWith("error.platform.")){var o=t.match(/^error\.platform\.(.+)$/);return(0,i.jsxs)("div",{"data-viz":"eventType","data-viz-keyword":"error",children:[(0,i.jsx)("em",{"data-viz":"eventType-keyword",children:"error:"})," ",(0,i.jsx)("div",{"data-viz":"eventType-text",children:o?o[1]:"??"})]})}return"DELAYED_INVALID"===(null===n||void 0===n?void 0:n.delayType)?(0,i.jsx)("div",{"data-viz":"eventType",children:t}):"DELAYED_VALID"===(null===n||void 0===n?void 0:n.delayType)?(0,i.jsxs)("div",{"data-viz":"eventType","data-viz-keyword":"after",children:[(0,i.jsx)("em",{"data-viz":"eventType-keyword",children:"after"})," ",(0,i.jsx)("div",{"data-viz":"eventType-text",children:n.delayString})]}):""===t?(0,i.jsx)("div",{"data-viz":"eventType","data-viz-keyword":"always",children:(0,i.jsx)("em",{"data-viz":"eventType-keyword",children:"always"})}):(0,i.jsx)("div",{"data-viz":"eventType",children:(0,i.jsx)("div",{"data-viz":"eventType-text",children:t})})};function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?En(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var On=function(e){var t=e.value;return(0,i.jsx)("div",{"data-viz":"stateNode-key",children:(0,i.jsx)("div",{"data-viz":"stateNode-keyText",title:t,children:t})})},wn=function e(t){var n,r,a,s,c=t.stateNode,l=t.node,d=Lt(),u=(0,p.L)(d),f=(0,o.Z)(u,1)[0],h=f.context.serviceDataMap[f.context.currentSessionId],v=null===h||void 0===h?void 0:h.state,y=null===h||void 0===h?void 0:h.machine,m=(0,g.useMemo)((function(){if(f.context.previewEvent)try{return null===y||void 0===y?void 0:y.transition(v,f.context.previewEvent)}catch(e){return void console.error(e)}}),[f,v,y]);if(!v)return null;var j=c.description||(null===(n=c.meta)||void 0===n?void 0:n.description);return(0,i.jsx)("div",{"data-viz":"stateNodeGroup","data-viz-active":!!v.configuration.find((function(e){return e.id===c.id}))||void 0,"data-viz-previewed":(null===m||void 0===m?void 0:m.configuration.find((function(e){return e.id===c.id})))||void 0,style:bn({position:"absolute"},l.layout&&{left:"".concat(l.layout.x,"px"),top:"".concat(l.layout.y,"px")}),children:(0,i.jsxs)("div",{"data-viz":"stateNode","data-viz-type":c.type,"data-viz-history":null!==(r=c.history)&&void 0!==r?r:void 0,"data-viz-parent-type":null===(a=c.parent)||void 0===a?void 0:a.type,"data-viz-atomic":["atomic","final"].includes(c.type)||void 0,"data-rect-id":c.id,style:bn({},l.layout&&{width:"".concat(l.layout.width,"px"),height:"".concat(l.layout.height,"px")}),children:[(0,i.jsxs)("div",{"data-viz":"stateNode-content","data-rect-id":"".concat(c.id,":content"),children:[(0,i.jsxs)("div",{"data-viz":"stateNode-header",children:[["history","final"].includes(c.type)&&(0,i.jsx)("div",{"data-viz":"stateNode-type","data-viz-type":c.type,"data-viz-history":null!==(s=c.history)&&void 0!==s?s:void 0}),(0,i.jsx)(On,{value:c.key}),c.tags.length>0&&(0,i.jsx)("div",{"data-viz":"stateNode-tags",children:c.tags.map((function(e,t){return(0,i.jsx)("div",{"data-viz":"stateNode-tag",children:e},t)}))})]}),c.definition.invoke.length>0&&(0,i.jsx)("div",{"data-viz":"stateNode-invocations",children:c.definition.invoke.map((function(e){return(0,i.jsx)(mn,{invoke:e},e.id)}))}),c.definition.entry.length>0&&(0,i.jsx)("div",{"data-viz":"stateNode-actions","data-viz-actions":"entry",children:c.definition.entry.map((function(e,t){return(0,i.jsx)(vn,{action:e,kind:"entry"},t)}))}),c.definition.exit.length>0&&(0,i.jsx)("div",{"data-viz":"stateNode-actions","data-viz-actions":"exit",children:c.definition.exit.map((function(e,t){return(0,i.jsx)(vn,{action:e,kind:"exit"},t)}))}),j&&(0,i.jsx)("div",{"data-viz":"stateNode-meta",children:(0,i.jsx)(on(),{components:{a:function(e){e.node;var t=(0,x.Z)(e,["node"]);return(0,i.jsx)(M.r,bn({},t))}},children:j})})]}),"states"in c&&(0,i.jsx)("div",{"data-viz":"stateNode-states",children:l.children.map((function(t){return(0,i.jsx)(e,{stateNode:t.data,node:t},t.id)}))})]})})},Sn=function(e){var t=e.active,n=e.duration;return(0,i.jsxs)("svg",{viewBox:"0 0 100 100","data-viz":"delay","data-viz-active":t||void 0,style:{transform:"rotate(-90deg)",display:"inline-block",width:"1rem",height:"1rem",overflow:"visible","--duration":n},children:[(0,i.jsx)("circle",{"data-viz":"delay-circle",cx:50,cy:50,r:45,strokeDasharray:1,pathLength:1,stroke:"#fff",fill:"transparent"}),(0,i.jsx)("circle",{"data-viz":"delay-fill",cx:50,cy:50,r:45,strokeDasharray:1,pathLength:1,stroke:"#fff",fill:"transparent"})]})};function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dn=function(e){var t,n;return null===(t=e.context.serviceDataMap[e.context.currentSessionId])||void 0===t||null===(n=t.machine.options)||void 0===n?void 0:n.delays},Cn=function(e){var t=e.edge,n=(e.index,e.position),r=t.transition,a=Lt(),s=(0,h.v)(a,(function(e){var t;return null===(t=e.context.serviceDataMap[e.context.currentSessionId])||void 0===t?void 0:t.state})),c=(0,h.v)(a,Dn),l=(0,g.useMemo)((function(){return c?function(e,t,n,r){try{if(!e.startsWith("xstate.after"))return;var i=e.match(/^xstate\.after\((.*)\)#.*$/);if(!i)return{delayType:"DELAYED_INVALID"};var a=(0,o.Z)(i,2)[1],s=+a;if(Number.isNaN(s)){var c=t[a];s="number"===typeof c?c:c(n,r)}return{delayType:"DELAYED_VALID",delay:s,delayString:gn(a)}}catch(l){return void console.log(l)}}(r.eventType,c,null===s||void 0===s?void 0:s.context,null===s||void 0===s?void 0:s.event):void 0}),[r.eventType,c,s]);if(!s)return null;var d,u="DELAYED_INVALID"===(null===l||void 0===l?void 0:l.delayType)||!s.nextEvents.includes(r.eventType),f=s.nextEvents.includes(t.transition.eventType)&&!!s.configuration.find((function(e){return e===t.source}));return(0,i.jsxs)("button",{"data-viz":"transition","data-viz-potential":f||void 0,"data-viz-disabled":u||void 0,"data-is-delayed":null!==l&&void 0!==l?l:void 0,"data-rect-id":t.id,style:Tn(Tn({position:"absolute"},n&&{left:"".concat(n.x,"px"),top:"".concat(n.y,"px")}),{},{"--delay":"DELAYED_VALID"===(null===l||void 0===l?void 0:l.delayType)&&l.delay}),disabled:u,onMouseEnter:function(){a.send({type:"EVENT.PREVIEW",eventType:r.eventType})},onMouseLeave:function(){a.send({type:"PREVIEW.CLEAR"})},onClick:function(){a.send({type:"SERVICE.SEND",event:(0,pt.toSCXMLEvent)({type:r.eventType},{origin:s._sessionid})})},children:[(0,i.jsxs)("div",{"data-viz":"transition-label",children:[(0,i.jsxs)("span",{"data-viz":"transition-event",children:[(0,i.jsx)(jn,{eventType:r.eventType,delay:l}),l&&"DELAYED_VALID"===l.delayType&&(0,i.jsx)(Sn,{active:f,duration:l.delay})]}),r.cond&&(0,i.jsx)("span",{"data-viz":"transition-guard",children:(d=r.cond,d.name)})]}),(0,i.jsx)("div",{"data-viz":"transition-content",children:r.actions.length>0&&(0,i.jsx)("div",{"data-viz":"transition-actions",children:r.actions.map((function(e,t){return(0,i.jsx)(vn,{action:e,kind:"do"},t)}))})}),r.description&&(0,i.jsx)("div",{"data-viz":"transition-description",children:(0,i.jsx)("p",{children:r.description})})]})},In=function(e){var t=(0,G.createModel)({digraph:e,elkGraph:void 0},{events:{GRAPH_UPDATED:function(e){return{digraph:e}}}});return t.createMachine({context:t.initialContext,initial:"loading",states:{loading:{entry:"notifyLayoutPending",invoke:{src:function(e){return function(e){return Qt.apply(this,arguments)}(e.digraph)},onDone:{target:"success",actions:[(0,Z.f0)({elkGraph:function(e,t){return t.data}}),"notifyLayoutReady"]}}},success:{on:{GRAPH_UPDATED:{target:"loading",actions:[t.assign({digraph:function(e,t){return t.digraph}})]}}}}})},Rn=function(e){var t=e.digraph,n=(0,g.useMemo)((function(){return Ft(t)}),[t]);return(0,i.jsxs)("div",{style:{opacity:.001},"data-viz":"machine","data-viz-id":t.id,children:[(0,i.jsx)(wn,{stateNode:t.data,node:t}),n.map((function(e,t){return(0,i.jsx)(Cn,{edge:e,index:t,position:e.label&&{x:e.label.x,y:e.label.y}},e.id)}))]})},kn=function(e){var t=e.elkNode;return(0,i.jsx)(wn,{stateNode:t.node.data,node:t.node})},Nn=(0,g.memo)(nn),An=(0,g.memo)(kn),_n=(0,g.memo)(Cn),zn=(0,g.memo)(Rn),Ln=function(e){var t=e.digraph,n=Lt(),r=(0,te.eO)((function(){return In(t)}),{actions:{notifyLayoutPending:function(){n.send("LAYOUT.PENDING")},notifyLayoutReady:function(){n.send("LAYOUT.READY")}}}),a=(0,o.Z)(r,2),s=a[0],c=a[1],l=P(),d=(0,h.v)(l,(function(e){return e.context})),u=d.viewbox,f=d.zoom;(0,g.useEffect)((function(){c({type:"GRAPH_UPDATED",digraph:t})}),[t,c]),(0,g.useEffect)((function(){l.send({type:"elkGraph.UPDATE",elkGraph:s.context.elkGraph})}),[s.context.elkGraph]);var p=(0,g.useMemo)((function(){return Ft(t)}),[t]);return s.matches("success")?(0,i.jsxs)("div",{"data-testid":"canvas-graph",style:{transformOrigin:"0 0",transform:"translate3d(".concat(-u.minX,"px, ").concat(-u.minY,"px, 0) scale(").concat(f,")")},children:[(0,i.jsx)(Nn,{digraph:t}),(0,i.jsx)(An,{elkNode:s.context.elkGraph.children[0]}),p.map((function(e,t){return(0,i.jsx)(_n,{edge:e,index:t,position:e.label&&{x:e.label.x,y:e.label.y}},e.id)}))]}):(0,i.jsx)(zn,{digraph:t})},Mn=n(5830),Vn=n(336),Zn=n(629);function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fn=function(e){var t=e.children;return(0,i.jsx)(xe.x,{fontSize:"3xl",fontWeight:"semibold",letterSpacing:"tighter",children:t})},Yn=function(e){var t=e.children;return(0,i.jsx)(xe.x,{color:"gray.200",lineHeight:"tall",children:t})},Hn={letterSpacing:"tight",fontWeight:"medium",bg:"gray.700",_hover:{bg:"gray.600",textDecoration:"none"},px:"4",py:"2",justifyContent:"start"},Bn=(0,Zn.C)({initial:"welcomeArea",states:{welcomeArea:{on:{CLICK_START_CODING:{target:"startCodingRightAway"},CLICK_SEE_EXAMPLE:{target:"seeingExample"}}},seeingExample:{entry:"requestExample"},startCodingRightAway:{}}}),Wn=function(){var e=(0,E.aC)(),t=(0,h.v)(e,dt.d6),n=(0,te.eO)(Bn,{actions:{requestExample:function(){return t.send("EXAMPLE_REQUESTED")}}}),r=(0,o.Z)(n,2),a=r[0],s=r[1];return(0,i.jsx)(Me,{zIndex:0,children:(0,i.jsxs)(u.xu,{maxW:"lg",p:"4",children:[a.matches("seeingExample")&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(R.Kq,{spacing:"4",children:[(0,i.jsxs)(R.Kq,{spacing:"2",children:[(0,i.jsx)(Fn,{children:"Here you go!"}),(0,i.jsx)(Yn,{children:"Here's an example of a state machine modelling a data fetch. You can press 'Visualize' to see the statechart appear."})]}),(0,i.jsx)(M.r,{color:"blue.300",fontSize:"sm",href:"https://stately.ai/docs/xstate",target:"_blank",rel:"noreferrer",children:"New to XState? Read the docs"})]})}),a.matches("startCodingRightAway")&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(R.Kq,{spacing:"4",children:[(0,i.jsxs)(R.Kq,{spacing:"2",children:[(0,i.jsx)(Fn,{children:"Go for it!"}),(0,i.jsx)(Yn,{children:"Start writing code in the right-hand panel, then press 'Visualize' to see the statechart appear."})]}),(0,i.jsx)(M.r,{color:"blue.300",fontSize:"sm",href:"https://stately.ai/docs/xstate",target:"_blank",rel:"noreferrer",children:"New to XState? Read here..."})]})}),a.matches("welcomeArea")&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(R.Kq,{spacing:"3",children:(0,i.jsxs)(R.Kq,{spacing:"6",children:[(0,i.jsx)(Fn,{children:(0,i.jsx)(Vn.X,{size:"lg",children:"Stately Visualizer"})}),(0,i.jsx)(xe.x,{color:"gray.400",size:"md",children:"Build state machine diagrams using XState."}),(0,i.jsxs)(R.Kq,{backgroundColor:"gray.700",spacing:"5",padding:"6",children:[(0,i.jsx)(xe.x,{children:"This legacy visualizer is deprecated and is no longer maintained."}),(0,i.jsxs)(xe.x,{children:["For the best experience,"," ",(0,i.jsx)(M.r,{href:"[EDITOR_LINK]",target:"_blank",color:"blue.300",className:"plausible-event-name=viz+stately-editor-button",children:"use our new Stately editor"})," ","to build and visualize state machines with drag-and-drop, AI assistance, exporting to XState V5, and more."]}),(0,i.jsxs)(xe.x,{children:["Full parity between the new Stately editor and this visualizer is coming soon.",(0,i.jsxs)(M.r,{href:"https://stately.ai/docs/visualizer",target:"_blank",color:"blue.300",className:"plausible-event-name=viz+docs",children:[" ","Read our docs for more information on the differences between the legacy visualizer and new visualizer."]})]}),(0,i.jsx)(xe.x,{children:(0,i.jsx)(_.z,Un(Un({},Hn),{},{as:M.r,href:"[EDITOR_LINK]",rel:"noreferrer",target:"_blank",bg:"orange.600",maxWidth:"auto",className:"plausible-event-name=viz+new-visualizer",children:(0,i.jsxs)(R.Ug,{spacing:"4",children:[(0,i.jsx)(Qe,{color:"gray.200",h:"6",w:"6"}),(0,i.jsx)(xe.x,{color:"gray.100",children:"Use the new Stately visualizer"})]})}))})]}),(0,i.jsxs)(R.Kq,{spacing:"3",children:[(0,i.jsx)(Vn.X,{size:"md",paddingTop:"3",fontWeight:"400",color:"gray.400",children:"Start using legacy visualizer"}),(0,i.jsx)(_.z,Un(Un({},Hn),{},{onClick:function(){return s("CLICK_SEE_EXAMPLE")},className:"plausible-event-name=viz+legacy-example",children:(0,i.jsxs)(R.Ug,{spacing:"4",children:[(0,i.jsx)(Mn.O,{color:"gray.200",h:"6",w:"6"}),(0,i.jsx)(xe.x,{color:"gray.100",children:"See an example"})]})})),(0,i.jsx)(_.z,Un(Un({},Hn),{},{as:M.r,href:"http://stately.ai/docs/xstate",rel:"noreferrer",target:"_blank",className:"plausible-event-name=viz+docs",children:(0,i.jsxs)(R.Ug,{spacing:"4",children:[(0,i.jsx)(rt,{color:"gray.200",h:"6",w:"6"}),(0,i.jsx)(xe.x,{color:"gray.100",children:"Learn how to build machines"})]})})),(0,i.jsx)(_.z,Un(Un({},Hn),{},{onClick:function(){return s("CLICK_START_CODING")},className:"plausible-event-name=viz+start-coding-using-legacy",children:(0,i.jsxs)(R.Ug,{spacing:"4",children:[(0,i.jsx)(it,{color:"gray.200",h:"6",w:"6"}),(0,i.jsx)(xe.x,{color:"gray.100",children:"Start coding right away"})]})}))]})]})})})]})})};function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qn=function(){var e=g.useState(!1),t=(0,o.Z)(e,2),n=t[0],r=t[1],a=(0,re.b)(),s=Lt(),c=P(),l=(0,dt.CN)(),d=(0,o.Z)(l,1)[0],f=(0,h.v)(s,(function(e){var t;return e.context.currentSessionId?null===(t=e.context.serviceDataMap[e.context.currentSessionId])||void 0===t?void 0:t.machine:void 0})),p=(0,h.v)(s,(function(e){return e.hasTag("layoutPending")})),v=(0,h.v)(s,(function(e){return e.hasTag("empty")})),x=(0,g.useMemo)((function(){return f?xt(f):void 0}),[f]),y=(0,h.v)(c,(function(e){return X(a)&&q(e.context)})),m=(0,h.v)(c,(function(e){return X(a)&&J(e.context)})),j=Mt(),E=d.hasTag("canShowWelcomeMessage"),b=(0,g.useMemo)((function(){return!(null!==a&&void 0!==a&&a.isEmbedded)||a.controls}),[a]),O=(0,g.useMemo)((function(){return!(null!==a&&void 0!==a&&a.isEmbedded)||a.controls&&a.zoom}),[a]),w=(0,g.useMemo)((function(){return!(null!==a&&void 0!==a&&a.isEmbedded)||a.controls&&a.pan}),[a]);return(0,i.jsxs)(u.xu,Xn(Xn({display:"grid",height:"100%"},!(null!==a&&void 0!==a&&a.isEmbedded)&&{gridTemplateRows:"3rem 1fr auto"}),{},{children:[!(null!==a&&void 0!==a&&a.isEmbedded)&&(0,i.jsx)(u.xu,{"data-testid":"canvas-header",bg:"gray.800",zIndex:1,padding:"0",children:(0,i.jsx)(ut,{})}),(0,i.jsxs)(pe,{panModeEnabled:n,children:[x&&(0,i.jsx)(Ln,{digraph:x}),p&&(0,i.jsx)(Me,{children:(0,i.jsx)(u.xu,{textAlign:"center",children:(0,i.jsxs)(R.gC,{spacing:"4",children:[(0,i.jsx)(k.$,{size:"xl"}),(0,i.jsx)(u.xu,{children:"Visualizing machine..."})]})})}),v&&E&&(0,i.jsx)(Wn,{})]}),b&&(0,i.jsxs)(u.xu,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",position:"absolute",bottom:0,left:0,paddingX:2,paddingY:3,zIndex:1,width:"100%","data-testid":"controls",children:[(0,i.jsxs)(N.h,{size:"sm",spacing:2,isAttached:!0,children:[O&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.h,{"aria-label":"Zoom out",title:"Zoom out",icon:(0,i.jsx)(T.V,{}),disabled:!y,onClick:function(){return c.send("ZOOM.OUT")},variant:"secondary"}),(0,i.jsx)(A.h,{"aria-label":"Zoom in",title:"Zoom in",icon:(0,i.jsx)(D.d,{}),disabled:!m,onClick:function(){return c.send("ZOOM.IN")},variant:"secondary"})]}),(0,i.jsx)(A.h,{"aria-label":"Fit to content",title:"Fit to content",icon:(0,i.jsx)(nt,{}),onClick:function(){return c.send("FIT_TO_CONTENT")},variant:"secondary"}),!(null!==a&&void 0!==a&&a.isEmbedded)&&(0,i.jsx)(A.h,{"aria-label":"Reset canvas",title:"Reset canvas",icon:(0,i.jsx)(C.n,{}),onClick:function(){return c.send("POSITION.RESET")},variant:"secondary"})]}),w&&(0,i.jsx)(A.h,{"aria-label":"Pan mode",icon:(0,i.jsx)(at,{}),size:"sm",marginLeft:2,onClick:function(){return r((function(e){return!e}))},"aria-pressed":n,variant:n?"secondaryPressed":"secondary"}),"visualizing"===j&&(0,i.jsx)(_.z,{size:"sm",marginLeft:2,onClick:function(){return s.send("MACHINES.RESET")},variant:"secondary",children:"RESET"}),!(null!==a&&void 0!==a&&a.isEmbedded)&&(0,i.jsxs)(z.v2,{closeOnSelect:!0,placement:"top-end",children:[(0,i.jsx)(z.j2,{as:A.h,size:"sm",isRound:!0,"aria-label":"More info",marginLeft:"auto",variant:"secondary",icon:(0,i.jsx)(I.w,{boxSize:6,css:{"& circle":{display:"none"}}})}),(0,i.jsx)(L.h,{children:(0,i.jsxs)(z.qy,{fontSize:"sm",padding:"0",children:[(0,i.jsx)(z.sN,{as:M.r,href:"https://github.com/statelyai/xstate-viz/issues/new?template=bug_report.md",target:"_blank",rel:"noreferrer",children:"Report an issue"}),(0,i.jsx)(z.sN,{as:M.r,href:"https://github.com/statelyai/xstate",target:"_blank",rel:"noreferrer",children:"XState version ".concat(V.i8)}),(0,i.jsx)(z.sN,{as:M.r,href:"https://stately.ai/privacy",target:"_blank",rel:"noreferrer",children:"Privacy Policy"})]})})]})]})]}))},Jn=n(747),$n=n(9887),Qn=function(){var e=(0,dt.CN)(),t=(0,o.Z)(e,2),n=t[0],r=t[1];return(0,i.jsxs)(ze.u_,{isOpen:n.matches("creating"),onClose:function(){return r({type:"CLOSE_NAME_CHOOSER_MODAL"})},children:[(0,i.jsx)(ze.ZA,{}),(0,i.jsx)(ze.hz,{children:(0,i.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=new FormData(e.target).get("name")||"";r({type:"CHOOSE_NAME",name:t})},children:[(0,i.jsx)(ze.xB,{children:"Choose Name"}),(0,i.jsx)(ze.fe,{children:(0,i.jsxs)(Ie.NI,{children:[(0,i.jsx)(Re.l,{fontSize:"sm",children:"Choose a name for your fork"}),(0,i.jsx)($n.I,{type:"text",name:"name",placeholder:"Unnamed Source",defaultValue:n.context.desiredMachineName||""})]})}),(0,i.jsx)(ze.mz,{children:(0,i.jsxs)(R.Ug,{children:[(0,i.jsx)(_.z,{type:"button",onClick:function(){return r({type:"CLOSE_NAME_CHOOSER_MODAL"})},disabled:n.hasTag("persisting"),children:"Cancel"}),(0,i.jsx)(_.z,{type:"submit",colorScheme:"blue",isLoading:n.hasTag("persisting"),children:"Submit"})]})})]})})]})},er=(0,b.Q6)("Palette"),tr=(0,o.Z)(er,2),nr=tr[0],rr=tr[1],ir=(0,G.createModel)(void 0,{events:{SHOW_PALETTE:function(){return{}},HIDE_PALETTE:function(){return{}}}}).createMachine({initial:"closed",states:{closed:{invoke:{src:function(){return function(e){var t=function(t){!(0,b.J6)(t.target)&&function(e){var t={"CtrlCMD+K":(0,b.fl)(e)&&"KeyK"===e.code,"Shift+?":e.shiftKey&&"Slash"===e.code};return Object.values(t).some(Boolean)}(t)&&(t.preventDefault(),e("SHOW_PALETTE"))};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}}},on:{SHOW_PALETTE:"opened"}},opened:{on:{HIDE_PALETTE:"closed"}}}}),or=n(3924),ar=n(478),sr=n(8125),cr=n(3762),lr=n(7974),dr=n(6029),ur=function(e){return e.context.serviceDataMap},fr=function(){var e=Lt(),t=(0,h.v)(e,ur),n=(0,h.v)(e,(function(e){return e.context.currentSessionId}));return(0,i.jsx)(cr.aV,{children:Object.entries(t).map((function(r){var a,s=(0,o.Z)(r,2),c=s[0],l=s[1];return(0,i.jsxs)(cr.HC,{display:"flex",flexDirection:"row",alignItems:"center",padding:2,marginTop:"0",opacity:n===c?1:.5,onClick:function(){e.send({type:"SERVICE.FOCUS",sessionId:c})},background:n===c?"whiteAlpha.200":"transparent",borderRadius:"md",_hover:{background:"whiteAlpha.100"},marginBottom:"2",cursor:"pointer",children:[(0,i.jsx)(cr.DE,{as:lr.m}),(0,i.jsxs)(xe.x,{flexGrow:1,textDecoration:(null===l||void 0===l?void 0:l.status)===dr.TM.Stopped?"line-through":void 0,"data-testid":"actor:".concat(c),children:[(null===l||void 0===l?void 0:l.parent)&&t[l.parent]&&(0,i.jsxs)("span",{children:[t[l.parent].machine.id," (",l.parent,") \u2192"," "]}),(0,i.jsx)("strong",{children:null!==(a=l.machine.id)&&void 0!==a?a:"(machine)"})," (",c,")"]})]},c)}))})},hr=n(4695),pr=n(1077),vr=n(8877),gr=n(2953),xr=n(4979),yr=n(6699),mr=n(5152),jr=n(2015),Er=n(6627),br=function(e){var t=e.isOpen,n=(0,jr.Xh)().openAndFocusFirstItem;return(0,g.useLayoutEffect)((function(){t&&n()}),[t,n]),null},Or=function(e){var t=e.onClick,n=e.command,r=e.children;return(0,i.jsxs)(z.sN,{fontWeight:"700",padding:"5",onClick:t,children:[r,(0,i.jsx)(u.xu,{as:"span",paddingLeft:"10",marginLeft:"auto",children:n})]})},wr=function(e){var t=e.onSave,n=e.onVisualize,r=(0,p.L)(rr()),a=(0,o.Z)(r,2),s=a[0],c=a[1],l=s.matches("opened"),d=function(){return c("HIDE_PALETTE")};return(0,i.jsxs)(ze.u_,{onClose:d,isOpen:l,isCentered:!0,motionPreset:"slideInBottom",children:[(0,i.jsx)(ze.ZA,{}),(0,i.jsx)(ze.hz,{minHeight:100,background:"none",boxShadow:"none",children:(0,i.jsx)(ze.fe,{display:"flex",justifyContent:"center",alignItems:"center",children:(0,i.jsxs)(z.v2,{defaultIsOpen:!0,isOpen:!0,closeOnSelect:!0,onClose:d,children:[(0,i.jsx)(br,{isOpen:l}),(0,i.jsxs)(z.qy,{paddingY:5,children:[(0,i.jsx)(Or,{onClick:t,command:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Er.T,{children:(0,b.ZS)()})," + ",(0,i.jsx)(Er.T,{children:"S"})]}),children:"Saves or updates the code in Stately Registry"}),(0,i.jsx)(Or,{onClick:n,command:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Er.T,{children:[" ",(0,b.ZS)()]})," + ",(0,i.jsx)(Er.T,{children:"Enter"})]}),children:"Visualizes the current editor code"})]})]})})})]})},Sr=n(7253),Pr=n(7575);function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cr=n.n(Pr)().makeRootRealm(),Ir=function(e){return function(){return e.apply(void 0,arguments)}},Rr={setInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return setInterval.apply(void 0,[Ir(e)].concat(n))})),setTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return setTimeout.apply(void 0,[Ir(e)].concat(n))})),clearTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return clearTimeout.apply(void 0,arguments)})),clearInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return clearInterval.apply(void 0,arguments)})),confirm:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return confirm.apply(void 0,arguments)})),prompt:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return prompt.apply(void 0,arguments)}))};function kr(e){var t=[],n=function(e){return function(){var n=e.apply(void 0,arguments);return t.push(n),n}};return Cr.evaluate(e,Dr({exports:{},require:function(e){switch(e){case"xstate":return Dr(Dr({},ne),{},{createMachine:n(Zn.C),Machine:n(Zn.J)});case"xstate/lib/actions":return Ve;case"xstate/lib/model":var t=G.createModel;return Dr(Dr({},G),{},{createModel:function(e,r){var i=t(e,r);return Dr(Dr({},i),{},{createMachine:n(i.createMachine)})}});default:throw new Error('External module ("'.concat(e,"\") can't be used."))}},console:{error:console.error,info:console.info,log:console.log,warn:console.warn},window:globalThis},Rr)),t}function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _r(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,gr.Z)(e);if(t){var i=(0,gr.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,vr.Z)(this,n)}}function zr(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Lr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mr(e){var t,n=[],r="",i=zr(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;switch(o){case"raise":n.push("actions"),r+="const { raise } = actions;\n";break;case"XState":r+='import * as XState from "xstate";\n';break;default:n.push(o)}}}catch(a){i.e(a)}finally{i.f()}return n.length&&(r="import { ".concat((0,b.jj)(n).join(", "),' } from "xstate";\n').concat(r)),r}var Vr=function(e){(0,pr.Z)(n,e);var t=_r(n);function n(e,r){var i;return(0,ft.Z)(this,n),i=t.call(this,e),(0,l.Z)((0,hr.Z)(i),"range",void 0),i.range=r,i}return(0,ht.Z)(n,[{key:"toString",value:function(){return this.message}},{key:"title",get:function(){return"SyntaxError at Line:".concat(this.range.startLineNumber," Col:").concat(this.range.endColumn)}}]),n}((0,xr.Z)(Error)),Zr=(0,mr.default)((function(){return n.e(454).then(n.bind(n,2454))}),{loadableGenerated:{webpack:function(){return[2454]},modules:["../EditorPanel.tsx -> ./EditorWithXStateImports"]}}),Gr=(0,G.createModel)({code:"",notifRef:void 0,monacoRef:null,standaloneEditorRef:null,sourceRef:null,mainFile:"main.ts",machines:null,deltaDecorations:[]},{events:{COMPILE:function(){return{}},EDITOR_READY:function(e,t){return{monacoRef:e,standaloneEditorRef:t}},UPDATE_MACHINE_PRESSED:function(){return{}},EDITOR_ENCOUNTERED_ERROR:function(e,t){return{message:e,title:t}},EDITOR_CHANGED_VALUE:function(e){return{code:e}}}}),Ur=Gr.createMachine({entry:[(0,Z.f0)({notifRef:function(){return(0,dr.Cs)(Sr.c)}})],initial:"booting",states:{booting:{initial:"waiting_for_monaco",on:{EDITOR_CHANGED_VALUE:void 0},states:{waiting_for_monaco:{on:{EDITOR_READY:[{cond:"isGist",target:"fixing_gist_imports",actions:Gr.assign({monacoRef:function(e,t){return t.monacoRef},standaloneEditorRef:function(e,t){return t.standaloneEditorRef}})},{target:"done",actions:Gr.assign({monacoRef:function(e,t){return t.monacoRef},standaloneEditorRef:function(e,t){return t.standaloneEditorRef}})}]}},fixing_gist_imports:{invoke:{src:function(){var e=(0,c.Z)(s().mark((function e(t){var n,r,i,o,a,c,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.monacoRef,r=n.Uri.parse(t.mainFile),e.next=4,n.languages.typescript.getTypeScriptWorker();case 4:return i=e.sent,e.next=7,i(r);case 7:return o=e.sent,e.next=10,o.queryXStateGistIdentifiers(r.toString());case 10:(a=e.sent).length>0&&(c=Mr(a),l=n.editor.getModel(r),d=l.getValue(),l.setValue("".concat(c,"\n").concat(d)));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onDone:"done",onError:{actions:["broadcastError"]}}},done:{type:"final"}},onDone:[{cond:function(e){return(0,dt.ew)(e.sourceRef.getSnapshot())},target:"compiling"},{target:"active"}]},active:{},updating:{tags:["visualizing"],entry:(0,Z.lW)("UPDATE_MACHINE_PRESSED"),always:"active"},compiling:{tags:["visualizing"],invoke:{src:function(){var e=(0,c.Z)(s().mark((function e(t){var n,r,i,o,a,c,l,d,u,f,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.monacoRef,r=n.Uri.parse(t.mainFile),e.next=4,n.languages.typescript.getTypeScriptWorker().then((function(e){return e(r)}));case 4:return i=e.sent,e.next=7,i.getSyntacticDiagnostics(r.toString());case 7:if(!((o=e.sent).length>0)){e.next=15;break}return c=null===(a=t.monacoRef)||void 0===a?void 0:a.editor.getModel(r),l=o[0],d=null===c||void 0===c?void 0:c.getPositionAt(l.start),u=null===c||void 0===c?void 0:c.getPositionAt(l.start+l.length),f=new t.monacoRef.Range(null===d||void 0===d?void 0:d.lineNumber,0,null===u||void 0===u?void 0:u.lineNumber,null===u||void 0===u?void 0:u.column),e.abrupt("return",Promise.reject(new Vr(l.messageText.toString(),f)));case 15:return e.next=17,i.getEmitOutput(r.toString()).then((function(e){return e.outputFiles[0].text}));case 17:return h=e.sent,e.abrupt("return",kr(h));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onDone:{target:"updating",actions:[(0,Z.f0)({machines:function(e,t){return t.data}})]},onError:[{cond:"isSyntaxError",target:"active",actions:["addDecorations","scrollToLineWithError","broadcastError"]},{target:"active",actions:["broadcastError"]}]}}},on:{EDITOR_CHANGED_VALUE:{actions:[Gr.assign({code:function(e,t){return t.code}}),"onChangedCodeValue","clearDecorations"]},EDITOR_ENCOUNTERED_ERROR:{actions:(0,Z.lW)((function(e,t){return{type:"BROADCAST",status:"error",message:t.message}}),{to:function(e){return e.notifRef}})},UPDATE_MACHINE_PRESSED:{actions:"onChange"},COMPILE:"compiling"}},{guards:{isGist:function(e){return"gist"===e.sourceRef.getSnapshot().context.sourceProvider},isSyntaxError:function(e,t){return t.data instanceof Vr}},actions:{broadcastError:(0,Z.lW)((function(e,t){return{type:"EDITOR_ENCOUNTERED_ERROR",title:t.data.title,message:t.data.message}})),addDecorations:(0,Z.f0)({deltaDecorations:function(e,t){var n=t.data.range;return e.standaloneEditorRef?e.standaloneEditorRef.deltaDecorations(e.deltaDecorations,[{range:n,options:{isWholeLine:!0,glyphMarginClassName:"editor__glyph-margin",className:"editor__error-content"}}]):e.deltaDecorations}}),clearDecorations:(0,Z.f0)({deltaDecorations:function(e){return e.standaloneEditorRef.deltaDecorations(e.deltaDecorations,[])}}),scrollToLineWithError:function(e,t){var n=t.data.range,r=e.standaloneEditorRef;null===r||void 0===r||r.revealLineInCenterIfOutsideViewport(n.startLineNumber)}}}),Fr=function(e){var t=e.onSave,n=e.onChange,r=e.onChangedCodeValue,a=e.onFork,s=e.onCreateNew,c=(0,re.b)(),l=(0,E.aC)(),d=(0,p.L)(l),f=(0,o.Z)(d,1)[0],v=(0,h.v)(l,(function(e){return e.context.sourceRef})),g=(0,p.L)(v),x=(0,o.Z)(g,1)[0],y=function(e){var t,n,r,i="no-source";return e.matches("no_source")||(i=e.context.loggedInUserId===(null===(t=e.context.sourceRegistryData)||void 0===t||null===(n=t.project)||void 0===n||null===(r=n.owner)||void 0===r?void 0:r.id)?"user-owns-source":"user-does-not-own-source"),i}(x),m=Mt(),j=function(e,t){if(e)switch(t){case"no-source":return{text:"Login to save",Icon:et};case"user-does-not-own-source":case"user-owns-source":return{text:"Login to fork",Icon:tt}}switch(t){case"no-source":case"user-owns-source":return{text:"Save",Icon:et};case"user-does-not-own-source":return{text:"Fork",Icon:tt}}}(f.matches("signed_out"),y),O=(0,dt.Ws)(x),w=(0,te.eO)(Ur,{actions:{onChange:function(e){n(e.machines)},onChangedCodeValue:function(e){r(e.code)}},context:Ar(Ar({},Gr.initialContext),{},{code:O,sourceRef:v})}),S=(0,o.Z)(w,2),P=S[0],T=S[1],C=P.hasTag("visualizing");return(0,i.jsxs)(i.Fragment,{children:["visualizing"===m&&(0,i.jsx)(wr,{onSave:function(){t()},onVisualize:function(){T("COMPILE")}}),(0,i.jsxs)(u.xu,{height:"100%",display:"grid",gridTemplateRows:"1fr auto","data-testid":"editor",children:["visualizing"===m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{minHeight:0,minWidth:0},children:(0,i.jsx)(Zr,{value:O,onMount:function(e,t){T({type:"EDITOR_READY",monacoRef:t,standaloneEditorRef:e})},onChange:function(e){T({type:"EDITOR_CHANGED_VALUE",code:e})},onFormat:function(){T({type:"COMPILE"})},onSave:function(){t()}})}),(0,i.jsxs)(R.Ug,{padding:"2",w:"full",justifyContent:"space-between",children:[(0,i.jsxs)(R.Ug,{children:[!(null!==c&&void 0!==c&&c.isEmbedded&&c.readOnly)&&(0,i.jsx)(yr.u,{bg:"black",color:"white",label:"".concat((0,b.ZS)()," + Enter"),closeDelay:500,children:(0,i.jsx)(_.z,{disabled:C,isLoading:C,leftIcon:(0,i.jsx)(Qe,{fill:"gray.200",height:"16px",width:"16px"}),onClick:function(){T({type:"COMPILE"})},variant:"secondary",children:"Visualize"})}),!(null!==c&&void 0!==c&&c.isEmbedded)&&(0,i.jsx)(yr.u,{bg:"black",color:"white",label:"".concat((0,b.ZS)()," + S"),closeDelay:500,children:(0,i.jsx)(_.z,{isLoading:x.hasTag("persisting"),disabled:x.hasTag("persisting"),onClick:function(){t()},leftIcon:(0,i.jsx)(j.Icon,{fill:"gray.200",height:"16px",width:"16px"}),variant:"outline",children:j.text})}),"user-owns-source"===y&&!(null!==c&&void 0!==c&&c.isEmbedded)&&(0,i.jsx)(_.z,{disabled:x.hasTag("forking"),isLoading:x.hasTag("forking"),onClick:function(){a()},leftIcon:(0,i.jsx)(tt,{fill:"gray.200",height:"16px",width:"16px"}),variant:"outline",children:"Fork"})]}),"no-source"!==y&&!(null!==c&&void 0!==c&&c.isEmbedded)&&(0,i.jsx)(_.z,{leftIcon:(0,i.jsx)(D.d,{fill:"gray.200"}),onClick:s,variant:"outline",children:"New"})]})]}),"inspecting"===m&&(0,i.jsxs)(u.xu,{padding:"4",children:[(0,i.jsx)(xe.x,{as:"strong",children:"Inspection mode"}),(0,i.jsx)(xe.x,{children:"Services from a separate process are currently being inspected."})]})]})]})},Yr=n(6780),Hr=n(6569),Br=n(6884),Wr=n(3346),Kr=n(8978),Xr=n(3606),qr=n(3604),Jr={base00:"transparent",base01:"var(--chakra-colors-gray-800)",base02:"var(--chakra-colors-gray-700)",base03:"var(--chakra-colors-gray-600)",base04:"var(--chakra-colors-gray-500)",base05:"var(--chakra-colors-gray-100)",base06:"var(--chakra-colors-gray-100)",base07:"var(--chakra-colors-gray-100)",base08:"var(--chakra-colors-red-100)",base09:"var(--chakra-colors-orange-300)",base0A:"var(--chakra-colors-orange-200)",base0B:"var(--chakra-colors-green-400)",base0C:"var(--chakra-colors-green-200)",base0D:"var(--chakra-colors-blue-200)",base0E:"var(--chakra-colors-purple-300)",base0F:"var(--chakra-colors-orange-500)"},$r=(0,Jn.G)()?(0,mr.default)((function(){return n.e(171).then(n.t.bind(n,5171,23))}),{loadableGenerated:{webpack:function(){return[5171]},modules:["../JSONView.tsx -> react-json-view"]}}):function(){return null},Qr=function(e){var t=e.src,n=e.name;return(0,i.jsx)($r,{src:t,name:n,theme:Jr,collapsed:1,onEdit:!1,displayDataTypes:!1,displayObjectSize:!1})};function ei(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ni=function(e){var t=e.event,n=Lt(),r=(0,h.v)(n,(function(e){var n;return t.origin&&(null===(n=e.context.serviceDataMap[t.origin])||void 0===n?void 0:n.machine.id)})),o=(0,h.v)(n,(function(e){var n;return null===(n=e.context.serviceDataMap[t.sessionId])||void 0===n?void 0:n.machine.id}));return(0,i.jsxs)(u.xu,{display:"inline-flex",flexDirection:"row",gap:"1ch",fontSize:"sm",children:[r&&(0,i.jsxs)(xe.x,{whiteSpace:"nowrap",children:[r," \u2192\xa0"]}),(0,i.jsx)(xe.x,{whiteSpace:"nowrap",children:o})]})},ri={position:"sticky",top:0,backgroundColor:"var(--chakra-colors-gray-800)",zIndex:1},ii={ASC:function(e){return e.sort((function(e,t){return e.timestamp<t.timestamp?1:-1}))},DESC:function(e){return e.sort((function(e,t){return e.timestamp>t.timestamp?1:-1}))}},oi=(0,G.createModel)({sortCriteria:null,filterKeyword:"",showBuiltins:!1,rawEvents:[]},{events:{SORT_BY_TIMESTAMP:function(e){return{sortCriteria:e}},FILTER_BY_KEYWORD:function(e){return{keyword:e}},TOGGLE_BUILTIN_EVENTS:function(e){return{showBuiltins:e}},EVENTS_UPDATED:function(e){return{events:e}}}}),ai=oi.createMachine({initial:"raw",context:oi.initialContext,states:{raw:{},modified:{}},on:{SORT_BY_TIMESTAMP:{target:"modified",actions:[oi.assign((function(e,t){return{sortCriteria:t.sortCriteria}}))]},FILTER_BY_KEYWORD:{target:"modified",actions:[oi.assign((function(e,t){return{filterKeyword:t.keyword}}))]},EVENTS_UPDATED:{actions:[oi.assign((function(e,t){return{rawEvents:t.events}}))]},TOGGLE_BUILTIN_EVENTS:{target:"modified",actions:[oi.assign((function(e,t){return{showBuiltins:t.showBuiltins}}))]}}}),si=function(){var e=Lt(),t=(0,p.L)(e),n=(0,o.Z)(t,2),r=n[0],a=n[1],s=r.context.events,c=(0,h.v)(e,(function(e){var t;return null===(t=function(e){return e.context.currentSessionId?e.context.serviceDataMap[e.context.currentSessionId]:void 0}(e))||void 0===t?void 0:t.state.nextEvents}),(function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),l=(0,te.eO)((function(){return ai}),{context:ti(ti({},oi.initialContext),{},{rawEvents:s})}),d=(0,o.Z)(l,2),f=d[0],v=d[1],x=function(e){var t=e.rawEvents;return e.showBuiltins||(t=t.filter((function(e){return!(0,b.tf)(e.name)&&!(0,b.qr)(e.name)}))),e.filterKeyword&&(t=t.filter((function(t){return t.name.toUpperCase().includes(e.filterKeyword.toUpperCase())}))),e.sortCriteria&&(t=ii[e.sortCriteria](t.slice())),t}(f.context);return(0,g.useEffect)((function(){v({type:"EVENTS_UPDATED",events:s})}),[s,v]),(0,i.jsxs)(u.xu,{display:"grid",gridTemplateRows:"auto 1fr auto",gridRowGap:"2",height:"100%",children:[(0,i.jsxs)(u.xu,{display:"flex",justifyContent:"flex-end",alignItems:"center",children:[(0,i.jsx)($n.I,{placeholder:"Filter events",type:"search",onChange:function(e){v({type:"FILTER_BY_KEYWORD",keyword:e.target.value})},marginRight:"auto",width:"40%"}),(0,i.jsxs)(u.xu,{display:"flex",alignItems:"center",children:[(0,i.jsx)(Re.l,{marginBottom:"0",marginRight:"1",htmlFor:"builtin-toggle",children:"Show built-in events"}),(0,i.jsx)(Ne.r,{id:"builtin-toggle",onChange:function(e){v({type:"TOGGLE_BUILTIN_EVENTS",showBuiltins:e.target.checked})}})]})]}),(0,i.jsx)(u.xu,{overflowY:"auto",children:(0,i.jsxs)(Wr.iA,{width:"100%",children:[(0,i.jsx)(Wr.hr,{children:(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsx)(Wr.Th,ti(ti({},ri),{},{width:"100%",children:"Event type"})),(0,i.jsx)(Wr.Th,ti(ti({},ri),{},{children:"To"})),(0,i.jsxs)(Wr.Th,ti(ti({},ri),{},{whiteSpace:"nowrap",children:["Time",(0,i.jsxs)(u.xu,{display:"inline-flex",flexDirection:"column",verticalAlign:"middle",marginLeft:"1",children:[(0,i.jsx)(A.h,{"aria-label":"sort by timestamp descending",title:"sort by timestamp descending",icon:(0,i.jsx)(Yr.g,{}),variant:"unstyled",size:"xs",bg:"DESC"===f.context.sortCriteria?"var(--chakra-colors-gray-700)":void 0,onClick:function(){v({type:"SORT_BY_TIMESTAMP",sortCriteria:"DESC"})}}),(0,i.jsx)(A.h,{"aria-label":"sort by timestamp ascending",title:"sort by timestamp ascending",icon:(0,i.jsx)(Hr.v,{}),variant:"unstyled",size:"xs",bg:"ASC"===f.context.sortCriteria?"var(--chakra-colors-gray-700)":void 0,onClick:function(){v({type:"SORT_BY_TIMESTAMP",sortCriteria:"ASC"})}})]})]}))]})}),(0,i.jsx)(Wr.p3,{children:x.map((function(e,t){return(0,i.jsx)(ci,{event:e},t)}))})]})}),(0,i.jsx)(ui,{onSend:function(e){return a({type:"SERVICE.SEND",event:e})},nextEvents:c})]})},ci=function(e){var t=e.event,n=(0,g.useState)(!1),r=n[0],o=n[1];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Wr.Tr,{cursor:"pointer",onClick:function(){return o(!r)},children:[(0,i.jsxs)(Wr.Td,{children:[r?(0,i.jsx)(Hr.v,{}):(0,i.jsx)(Br.X,{}),t.name]}),(0,i.jsx)(Wr.Td,{color:"gray.500",textAlign:"right",children:(0,i.jsx)(ni,{event:t})}),(0,i.jsx)(Wr.Td,{color:"gray.500",children:(0,qr.Z)(t.timestamp,"H:mm:ss")})]}),r?(0,i.jsx)(Wr.Tr,{children:(0,i.jsx)(Wr.Td,{colSpan:3,children:(0,i.jsx)(Qr,{src:t.data})})}):null]})},li=(0,G.createModel)({eventString:'{\n\t"type": ""\n}'},{events:{"EVENT.PAYLOAD":function(e){return{value:e}},"EVENT.SEND":function(){return{}},"EVENT.RESET":function(){return{}}}}),di=li.createMachine({type:"parallel",states:{validity:{initial:"invalid",states:{invalid:{},valid:{tags:"valid"}},on:{"*":[{cond:function(e){try{return"string"===typeof JSON.parse(e.eventString).type}catch(t){return!1}},target:".valid"},{target:".invalid"}]}},editing:{on:{"EVENT.PAYLOAD":{actions:(0,Z.f0)({eventString:function(e,t){return t.value}})},"EVENT.SEND":{actions:["sendEvent",(0,Z.lW)("EVENT.RESET")]},"EVENT.RESET":{actions:li.reset()}}}}}),ui=function(e){var t=e.onSend,n=e.nextEvents,r=(0,te.eO)(di,{actions:{sendEvent:function(e){try{var n=(0,pt.toSCXMLEvent)(JSON.parse(e.eventString));t(n)}catch(r){console.error(r)}}}}),a=(0,o.Z)(r,2),s=a[0],c=a[1];return(0,i.jsx)(u.xu,{display:"flex",flexDirection:"row",css:{gap:".5rem"},children:(0,i.jsx)(Kr.J2,{children:function(e){var t=e.onClose;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Kr.xo,{children:(0,i.jsx)(_.z,{variant:"outline",children:"Send event"})}),(0,i.jsx)(L.h,{children:(0,i.jsxs)(Kr.yk,{children:[(0,i.jsx)(Kr.QH,{}),(0,i.jsx)(Kr.Yt,{display:"flex",flexWrap:"wrap",css:{gap:".5rem"},children:n&&n.map((function(e){return(0,i.jsx)(_.z,{size:"xs",colorScheme:"blue",onClick:function(){return c(li.events["EVENT.PAYLOAD"]('{\n\t"type": "'.concat(e,'"\n}')))},children:e},e)}))}),(0,i.jsx)(Kr.b,{bg:"gray.800",children:(0,i.jsx)(Xr.ZP,{language:"json",options:{minimap:{enabled:!1},lineNumbers:"off",tabSize:2},height:"150px",width:"auto",value:s.context.eventString,onChange:function(e){e&&c(li.events["EVENT.PAYLOAD"](e))}})}),(0,i.jsx)(Kr.DT,{display:"flex",justifyContent:"flex-end",children:(0,i.jsxs)(N.h,{spacing:2,children:[(0,i.jsx)(_.z,{variant:"ghost",onClick:function(){c(li.events["EVENT.RESET"]()),t()},children:"Cancel"}),(0,i.jsx)(_.z,{disabled:!s.hasTag("valid"),onClick:function(){c(li.events["EVENT.SEND"]()),t()},children:"Send"})]})})]})})]})}})})};function fi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fi(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pi=(0,G.createModel)({ref:null,widthDelta:0},{events:{DRAG_SESSION_STARTED:function(e){return{point:e.point}},DRAG_SESSION_STOPPED:function(){return{}},POINTER_MOVED_BY:function(e){return{delta:e.delta}}}}),vi=pi.createMachine({invoke:{id:"dragSessionTracker",src:function(e){return ce.withContext(hi(hi({},se.initialContext),{},{ref:e.ref}))}},initial:"idle",states:{idle:{on:{DRAG_SESSION_STARTED:"active"}},active:{on:{POINTER_MOVED_BY:{actions:(0,Z.f0)({widthDelta:function(e,t){return Math.max(0,e.widthDelta-t.delta.x)}})},DRAG_SESSION_STOPPED:"idle"}}}}),gi=function(e){var t=e.onChange,n=(0,g.useRef)(null),r=(0,te.eO)(vi.withContext(hi(hi({},pi.initialContext),{},{ref:n}))),a=(0,o.Z)(r,1)[0];return(0,g.useEffect)((function(){t(a.context.widthDelta)}),[a.context.widthDelta,t]),(0,i.jsx)(u.xu,{ref:n,"data-testid":"resize-handle",width:"1",css:{position:"absolute",top:0,left:0,height:"100%",cursor:"ew-resize",opacity:0,transition:"opacity 0.2s ease"},_hover:{opacity:1,background:"var(--chakra-colors-blue-300)"},_before:{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",transform:"scaleX(2)"}})},xi=function(e){var t=e.children,n=e.disabled,r=(0,x.Z)(e,["children","disabled"]),o=(0,g.useState)(0),a=o[0],s=o[1];return(0,i.jsxs)(u.xu,hi(hi({},r),{},{style:n?void 0:{width:"clamp(36rem, calc(36rem + ".concat(a,"px), 70vw)")},children:[t,!n&&(0,i.jsx)(gi,{onChange:function(e){return s(e)}})]}))},yi=n(3091),mi=n(430),ji=function(){return(0,i.jsxs)(u.xu,{children:[(0,i.jsx)(Vn.X,{as:"h2",fontSize:"l",marginBottom:"5",children:"Keyboard shortcuts"}),(0,i.jsxs)(Wr.iA,{size:"sm",children:[(0,i.jsx)(Wr.hr,{children:(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsx)(Wr.Th,{children:"Keybinding"}),(0,i.jsx)(Wr.Th,{children:"Description"})]})}),(0,i.jsxs)(Wr.p3,{children:[(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsxs)(Wr.Td,{children:[(0,i.jsx)(Er.T,{children:(0,b.ZS)()})," + ",(0,i.jsx)(Er.T,{children:"S"})]}),(0,i.jsx)(Wr.Td,{children:"Saves or updates the code in Stately Registry"})]}),(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsxs)(Wr.Td,{children:[(0,i.jsx)(Er.T,{children:(0,b.ZS)()})," + ",(0,i.jsx)(Er.T,{children:"Enter"})]}),(0,i.jsx)(Wr.Td,{children:"Visualizes the current editor code"})]}),(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsx)(Wr.Td,{children:(0,i.jsxs)(R.gC,{alignItems:"flex-start",children:[(0,i.jsxs)("span",{children:[(0,i.jsx)(Er.T,{children:(0,b.ZS)()})," + ",(0,i.jsx)(Er.T,{children:"K"})]}),(0,i.jsxs)("span",{children:[(0,i.jsx)(Er.T,{children:"Shift"})," + ",(0,i.jsx)(Er.T,{children:"?"})]})]})}),(0,i.jsx)(Wr.Td,{children:"Show the Command palette"})]}),(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsx)(Wr.Td,{children:(0,i.jsx)(R.gC,{alignItems:"flex-start",children:(0,i.jsxs)("span",{children:[(0,i.jsx)(Er.T,{children:"Up"})," , ",(0,i.jsx)(Er.T,{children:"Left"})," , ",(0,i.jsx)(Er.T,{children:"Down"})," , ",(0,i.jsx)(Er.T,{children:"Right"})]})})}),(0,i.jsxs)(Wr.Td,{children:["Pan the view. Use ",(0,i.jsx)(Er.T,{children:"Shift"})," for a larger pan."]})]}),(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsxs)(Wr.Td,{children:[(0,i.jsx)(Er.T,{children:"Shift"})," + ",(0,i.jsx)(Er.T,{children:"1"})]}),(0,i.jsx)(Wr.Td,{children:"Fit to content"})]}),(0,i.jsxs)(Wr.Tr,{children:[(0,i.jsx)(Wr.Td,{children:(0,i.jsx)(R.gC,{alignItems:"flex-start",children:(0,i.jsxs)("span",{children:[(0,i.jsx)(Er.T,{children:"+"})," , ",(0,i.jsx)(Er.T,{children:"-"})]})})}),(0,i.jsx)(Wr.Td,{children:"Zoom-in/out"})]})]})]})]})},Ei=function(){var e=(0,mi.g)(),t=Mt();return(0,i.jsxs)(R.gC,{paddingY:"5",spacing:"7",alignItems:"stretch",children:["visualizing"===t&&(0,i.jsx)(ji,{}),(0,i.jsxs)(u.xu,{children:[(0,i.jsx)(Vn.X,{as:"h2",fontSize:"l",marginBottom:"5",children:"Editor theme"}),(0,i.jsx)(ke.Ph,{maxWidth:"fit-content",defaultValue:e.theme,onChange:function(t){var n=t.target.value;e.switchTheme(n)},children:Object.keys(yi.n).map((function(e){return(0,i.jsx)("option",{value:e,children:yi.n[e].name},e)}))})]})]})},bi=n(750),Oi=function(e){var t;return e.context.currentSessionId?null===(t=e.context.serviceDataMap[e.context.currentSessionId])||void 0===t?void 0:t.state:void 0},wi=function(e){var t=e.state,n=null===t||void 0===t?void 0:t.value,r=null===t||void 0===t?void 0:t.context;return(0,i.jsxs)(u.xu,{"data-testid":"state-panel",children:[(0,i.jsx)(Qr,{src:"string"===typeof n?{_:n}:n,name:"Value"}),(0,i.jsx)(Qr,{src:r,name:"Context"}),(0,i.jsx)(Qr,{src:t,name:"State"})]})},Si=function(){var e=(0,h.v)(Lt(),Oi);return(0,i.jsx)(wi,{state:e})};function Pi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pi(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Di=function(e){var t=(0,re.b)(),n=Lt(),r=(0,h.v)(n,ur),a=(0,dt.CN)(),s=(0,o.Z)(a,2),c=s[0],l=s[1],d=(0,g.useState)((function(){return null!==t&&void 0!==t&&t.isEmbedded?(0,b.xr)(t.panel):0})),u=d[0],f=d[1];return(0,g.useEffect)((function(){null!==t&&void 0!==t&&t.isEmbedded&&f((0,b.xr)(t.panel))}),[t]),(0,i.jsx)(xi,Ti(Ti({},e),{},{gridArea:"panels",minHeight:0,disabled:(null===t||void 0===t?void 0:t.isEmbedded)&&t.mode!==Le.T.Full,hidden:(null===t||void 0===t?void 0:t.isEmbedded)&&t.mode===Le.T.Viz,"data-testid":"panels-view",children:(0,i.jsxs)(ar.mQ,{bg:"gray.800",display:"grid",gridTemplateRows:"3rem 1fr",height:"100%",index:u,onChange:function(e){f(e)},children:[(0,i.jsxs)(ar.td,{children:[(0,i.jsx)(ar.OK,{children:"Code"}),(0,i.jsx)(ar.OK,{children:"State"}),(0,i.jsx)(ar.OK,{children:"Events"}),(0,i.jsxs)(ar.OK,{children:["Actors"," ",(0,i.jsx)(sr.C,{fontSize:"x-small",marginLeft:"1",colorScheme:"blue",children:Object.values(r).length})]}),!(null!==t&&void 0!==t&&t.isEmbedded)&&(0,i.jsx)(ar.OK,{marginLeft:"auto",marginRight:"2",children:(0,i.jsx)(or.e,{"aria-label":"Settings"})}),(null===t||void 0===t?void 0:t.isEmbedded)&&t.showOriginalLink&&t.originalUrl&&(0,i.jsx)(_.z,{height:"100%",rounded:"none",marginLeft:"auto",colorScheme:"blue",as:"a",target:"_blank",rel:"noopener noreferer nofollow",href:null===t||void 0===t?void 0:t.originalUrl,leftIcon:(0,i.jsx)(Pe.h,{}),children:"Open in Stately.ai/viz"})]}),(0,i.jsxs)(ar.nP,{minHeight:0,children:[(0,i.jsxs)(ar.x4,{height:"100%",padding:0,children:[c.matches({with_source:"loading_content"})&&(0,i.jsx)(bi.f,{text:"Loading source from ".concat(c.context.sourceProvider)}),!c.matches({with_source:"loading_content"})&&(0,i.jsx)(Fr,{onChangedCodeValue:function(e){l({type:"CODE_UPDATED",code:e,sourceID:c.context.sourceID})},onCreateNew:function(){return l({type:"CREATE_NEW"})},onSave:function(){l({type:"SAVE"})},onChange:function(e){n.send({type:"MACHINES.REGISTER",machines:e})},onFork:function(){l({type:"FORK"})}})]}),(0,i.jsx)(ar.x4,{height:"100%",overflowY:"auto",children:(0,i.jsx)(Si,{})}),(0,i.jsx)(ar.x4,{height:"100%",overflow:"hidden",children:(0,i.jsx)(si,{})}),(0,i.jsx)(ar.x4,{height:"100%",overflowY:"auto",children:(0,i.jsx)(fr,{})}),!(null!==t&&void 0!==t&&t.isEmbedded)&&(0,i.jsx)(ar.x4,{height:"100%",overflowY:"auto",children:(0,i.jsx)(Ei,{})})]})]})}))},Ci=n(8172),Ii=n(524),Ri=(0,Ii.Bw)();function ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}globalThis.__xstate__=Ri;var Ai=(0,G.createModel)({state:void 0,notifRef:void 0,serviceDataMap:{},currentSessionId:null,events:[],previewEvent:void 0},{events:{"SERVICE.SEND":function(e){return{event:e}},"MACHINES.REGISTER":function(e){return{machines:e}},"MACHINES.RESET":function(){return{}},"EVENT.PREVIEW":function(e){return{eventType:e}},"PREVIEW.CLEAR":function(){return{}},"SERVICE.REGISTER":function(e){return Ni(Ni({},e),{},{status:dr.TM.Running})},"SERVICE.STATE":function(e,t){return{sessionId:e,state:t}},"SERVICES.UNREGISTER_ALL":function(){return{}},"SERVICE.STOP":function(e){return{sessionId:e}},"SERVICE.FOCUS":function(e){return{sessionId:e}},ERROR:function(e){return{message:e}},"LAYOUT.PENDING":function(){return{}},"LAYOUT.READY":function(){return{}}}}),_i=Ai.createMachine({preserveActionOrder:!0,context:Ai.initialContext,initial:(0,Jn.G)()&&new URLSearchParams(window.location.search).has("inspect")?"inspecting":"visualizing",entry:(0,Z.f0)({notifRef:function(){return(0,dr.Cs)(Sr.c)}}),invoke:{src:"captureEventsFromChildServices"},states:{inspecting:{tags:"inspecting",invoke:{id:"proxy",src:function(){return function(e,t){var n,r=new URLSearchParams(window.location.search).get("server");if(r){var i=r.split("://"),o=(0,bt.Z)(i),a=o[0],s=o.slice(1);n=(0,Ii.Yk)({protocol:a,server:s.join("://")})}else n=(0,Ii.Kg)({targetWindow:window.opener||window.parent});return t((function(e){"xstate.event"===e.type&&n.send(Ni(Ni({},e),{},{type:"xstate.event",event:JSON.stringify(e.event)}))})),n.subscribe((function(t){switch(t.type){case"service.register":var n=t.machine.resolveState(t.state);e(Ai.events["SERVICE.REGISTER"]({sessionId:t.sessionId,machine:t.machine,state:n,parent:t.parent,source:"inspector"}));break;case"service.state":e(Ai.events["SERVICE.STATE"](t.sessionId,t.state));break;case"service.stop":e(Ai.events["SERVICE.STOP"](t.sessionId))}})).unsubscribe}}}},visualizing:{tags:"visualizing",invoke:{id:"proxy",src:function(){return function(e,t){var n=new Map,r=new Set,i=new Set;function o(t){var o;r.add(t);var a=(0,dr.kJ)(t,{devTools:!0});i.add(a),n.set(a.sessionId,a),e(Ai.events["SERVICE.REGISTER"]({sessionId:a.sessionId,machine:a.machine,state:a.machine.initialState,parent:null===(o=a.parent)||void 0===o?void 0:o.sessionId,source:"visualizer"})),a.subscribe((function(t){e(Ai.events["SERVICE.STATE"](a.sessionId,t))})),a.start()}function a(){i.forEach((function(t){e(Ai.events["SERVICES.UNREGISTER_ALL"]()),t.stop()})),i.clear(),n.clear()}t((function(t){if("INTERPRET"===t.type)t.machines.forEach((function(t){try{o(t)}catch(n){e(Ai.events.ERROR(n.message))}}));else if("xstate.event"===t.type){var i=n.get(t.sessionId);if(i)try{i.send(t.event)}catch(s){console.error(s),e(Ai.events.ERROR(s.message))}}else"RESET"===t.type?(a(),r.forEach((function(e){o(e)}))):"STOP"===t.type&&(a(),r.clear())}))}}},initial:"idle",states:{idle:{tags:"empty"},pending:{tags:"layoutPending",on:{"LAYOUT.READY":"ready"}},ready:{}},on:{"LAYOUT.PENDING":".pending","MACHINES.REGISTER":{actions:["resetVisualizationState",(0,Z.lW)("STOP",{to:"proxy"}),(0,Z.lW)((function(e,t){return{type:"INTERPRET",machines:t.machines}}),{to:"proxy"})]},"MACHINES.RESET":{actions:["resetVisualizationState",(0,Z.lW)("RESET",{to:"proxy"})]}}}},on:{"SERVICE.STATE":{actions:[Ai.assign({serviceDataMap:function(e,t){return(0,Ci.ZP)(e.serviceDataMap,(function(e){var n=e[t.sessionId];n&&(e[t.sessionId].state=n.machine.resolveState(t.state))}))},events:function(e,t){return(0,Ci.ZP)(e.events,(function(e){e.push(Ni(Ni({},t.state._event),{},{timestamp:Date.now(),sessionId:t.sessionId}))}))}})]},"SERVICE.SEND":{actions:[(0,Z.lW)((function(e,t){return{type:"xstate.event",event:t.event,sessionId:e.currentSessionId}}),{to:"proxy"})]},"SERVICE.REGISTER":{actions:Ai.assign({serviceDataMap:function(e,t){t.type;var n=(0,x.Z)(t,["type"]);return(0,Ci.ZP)(e.serviceDataMap,(function(e){e[n.sessionId]=n}))},currentSessionId:function(e,t){var n;return null!==(n=e.currentSessionId)&&void 0!==n?n:t.sessionId}})},"SERVICES.UNREGISTER_ALL":{actions:Ai.assign({serviceDataMap:{},currentSessionId:null})},"SERVICE.STOP":{actions:Ai.assign({serviceDataMap:function(e,t){return(0,Ci.ZP)(e.serviceDataMap,(function(e){var n=e[t.sessionId];n&&(n.status=dr.TM.Stopped)}))}})},"SERVICE.FOCUS":{actions:Ai.assign({currentSessionId:function(e,t){return t.sessionId}})},"EVENT.PREVIEW":{actions:Ai.assign({previewEvent:function(e,t){return t.eventType}})},"PREVIEW.CLEAR":{actions:Ai.assign({previewEvent:void 0})},ERROR:{actions:(0,Z.lW)((function(e,t){return{type:"BROADCAST",status:"error",message:t.message}}),{to:function(e){return e.notifRef}})}}},{services:{captureEventsFromChildServices:function(){return function(e){Ri.onRegister((function(t){var n;t.parent&&(e(Ai.events["SERVICE.REGISTER"]({sessionId:t.sessionId,machine:t.machine,state:t.state||t.initialState,parent:null===(n=t.parent)||void 0===n?void 0:n.sessionId,source:"child"})),t.subscribe((function(n){n&&e(Ai.events["SERVICE.STATE"](t.sessionId,n))})),t.onStop((function(){e(Ai.events["SERVICE.STOP"](t.sessionId))})))}))}}},actions:{resetVisualizationState:Ai.assign({events:[],previewEvent:void 0,currentSessionId:null})}}),zi=(0,n(2775).B)({config:{initialColorMode:"dark",useSystemColorMode:!1},styles:{global:{"*, *:before, *:after":{position:"relative"},body:{overflow:"hidden",overscrollBehavior:"none",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif"},"#root":{height:"100vh",width:"100vw",overflow:"hidden"},".monaco-editor *":{position:"static"}}},components:{Button:{variants:{secondary:{bg:"gray.600",color:"white",_hover:{bg:"gray.400"}},secondaryPressed:{bg:"gray.600",color:"#679ae7",_hover:{bg:"#679ae7",color:"white"}}}}}});function Li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Li(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gi={title:"XState Visualizer",ogTitle:"XState Visualizer",description:"Visualizer for XState state machines and statecharts",ogImageUrl:null},Ui=function(){var e,t,n,r=(0,dt.wu)();return r?(0,i.jsx)(j,{title:[null===(e=r.project)||void 0===e?void 0:e.name,Gi.title].filter(Boolean).join(" | "),ogTitle:(null===(t=r.project)||void 0===t?void 0:t.name)||Gi.ogTitle,description:(null===(n=r.project)||void 0===n?void 0:n.name)||Gi.description,ogImageUrl:Se(r.id)}):(0,i.jsx)(j,Zi({},Gi))},Fi=function(e){return null!==e&&void 0!==e&&e.isEmbedded&&e.mode===Le.T.Viz?"canvas":null!==e&&void 0!==e&&e.isEmbedded&&e.mode===Le.T.Panels?"panels":"canvas panels"};var Yi=function(e){var t,n=e.isEmbedded,r=void 0!==n&&n,a=(0,v.useRouter)(),l=a.query,x=a.asPath,y=(0,g.useMemo)((function(){return Zi(Zi({},(0,b.tT)(l)),{},{isEmbedded:r,originalUrl:(0,b.yO)(l)})}),[l,x]),m=(0,f.k)(ir),j=(0,f.k)(_i),O=(0,h.v)(j,(function(e){var t;return e.context.currentSessionId?null===(t=e.context.serviceDataMap[e.context.currentSessionId])||void 0===t?void 0:t.machine:void 0})),w=(0,h.v)((0,E.aC)(),dt.d6),P=(0,p.L)(w),T=(0,o.Z)(P,2),D=T[0],C=T[1];t={EMBED_PARAMS_CHANGED:function(e){v.default.replace(e.url,e.url)}},(0,g.useEffect)((function(){window.onmessage=function(){var e=(0,c.Z)(s().mark((function e(n){var r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.data,t&&(null===(r=t[i.type])||void 0===r||r.call(t,i));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),[]),(0,g.useEffect)((function(){C({type:"MACHINE_ID_CHANGED",id:(null===O||void 0===O?void 0:O.id)||""})}),[null===O||void 0===O?void 0:O.id,C]);var I=function(e){var t=e.sourceID,n=e.embed,r=(0,f.k)(Q,{actions:{persistPositionToLocalStorage:function(e){var n=e.zoom,r=e.viewbox,i=e.embed;null!==i&&void 0!==i&&i.isEmbedded||U.q.savePosition(t,{zoom:n,viewbox:r})}},context:Mi(Mi({},B.initialContext),{},{embed:n})});return(0,g.useEffect)((function(){r.send({type:"SOURCE_CHANGED",id:t})}),[t,r]),r}({sourceID:D.context.sourceID,embed:y});return(0,Jn.G)()?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Ui,{}),(0,i.jsx)(re.w,{value:y,children:(0,i.jsx)(d.x,{theme:zi,children:(0,i.jsx)(mi.W,{children:(0,i.jsx)(nr,{value:m,children:(0,i.jsx)(zt,{value:j,children:(0,i.jsxs)(u.xu,{"data-testid":"app","data-viz-theme":"dark",as:"main",display:"grid",gridTemplateColumns:"1fr auto",gridTemplateAreas:'"'.concat(Fi(y),'"'),height:"100vh",children:[!(null!==y&&void 0!==y&&y.isEmbedded&&y.mode===Le.T.Panels)&&(0,i.jsx)(S,{value:I,children:(0,i.jsx)(qn,{})}),(0,i.jsx)(Di,{}),(0,i.jsx)(Qn,{})]})})})})})})]}):(0,i.jsx)(Ui,{})}},430:function(e,t,n){"use strict";n.d(t,{W:function(){return u},g:function(){return d}});var r=n(5893),i=n(3934),o=n(7294),a=n(8415),s=(0,n(8052).Q6)("EditorTheme"),c=(0,i.Z)(s,2),l=c[0],d=c[1];function u(e){var t=e.children,n=(0,o.useState)((function(){return a.q.getEditorTheme()||"xstateViz"})),i=n[0],s=n[1],c=(0,o.useMemo)((function(){return{theme:i,switchTheme:s}}),[i]);return(0,r.jsx)(l,{value:c,children:t})}},4989:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[[...sourceFileId]]",function(){return n(4486)}])}},function(e){e.O(0,[774,492,888,179],(function(){return t=4989,e(e.s=t);var t}));var t=e.O();_N_E=t}]);